"use strict";(self.webpackChunkowncast_web=self.webpackChunkowncast_web||[]).push([[3287],{"./components/modals/NameChangeModal/NameChangeModal.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{NameChangeModal:()=>NameChangeModal});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),es=__webpack_require__("./node_modules/recoil/es/index.js"),es_select=__webpack_require__("./node_modules/antd/es/select/index.js"),es_button=__webpack_require__("./node_modules/antd/es/button/index.js"),es_form=__webpack_require__("./node_modules/antd/es/form/index.js"),input=__webpack_require__("./node_modules/antd/es/input/index.js"),next_export_i18n=__webpack_require__("./node_modules/next-export-i18n/index.js"),socket_events=__webpack_require__("./interfaces/socket-events.ts"),ClientConfigStore=__webpack_require__("./components/stores/ClientConfigStore.tsx");const UNICODE_WHITESPACE_CLASS="[\\s\\u00A0\\u1680\\u180E\\u2000-\\u200A\\u200B-\\u200D\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]";function validateDisplayName(name,currentName,characterLimit=30){if(void 0===name)return{isValid:!1,errorMessage:"Display name is required"};const trimmedName=function trimUnicodeWhitespace(str){const unicodeWhitespacePattern=new RegExp(`^${UNICODE_WHITESPACE_CLASS}+|${UNICODE_WHITESPACE_CLASS}+$`,"g");return str.replace(unicodeWhitespacePattern,"")}(name);if(0===trimmedName.length)return{isValid:!1,errorMessage:"Display name cannot be empty or contain only whitespace"};if(trimmedName===currentName)return{isValid:!1,errorMessage:"New name must be different from current name"};return Array.from(trimmedName).length>characterLimit?{isValid:!1,errorMessage:`Display name cannot exceed ${characterLimit} characters`}:{isValid:!0,trimmedName}}var Translation=__webpack_require__("./components/ui/Translation/Translation.tsx"),localization=__webpack_require__("./types/localization.ts"),injectStylesIntoStyleTag=__webpack_require__("./node_modules/@storybook/nextjs/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),styleDomAPI=__webpack_require__("./node_modules/@storybook/nextjs/node_modules/style-loader/dist/runtime/styleDomAPI.js"),styleDomAPI_default=__webpack_require__.n(styleDomAPI),insertBySelector=__webpack_require__("./node_modules/@storybook/nextjs/node_modules/style-loader/dist/runtime/insertBySelector.js"),insertBySelector_default=__webpack_require__.n(insertBySelector),setAttributesWithoutAttributes=__webpack_require__("./node_modules/@storybook/nextjs/node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),setAttributesWithoutAttributes_default=__webpack_require__.n(setAttributesWithoutAttributes),insertStyleElement=__webpack_require__("./node_modules/@storybook/nextjs/node_modules/style-loader/dist/runtime/insertStyleElement.js"),insertStyleElement_default=__webpack_require__.n(insertStyleElement),styleTagTransform=__webpack_require__("./node_modules/@storybook/nextjs/node_modules/style-loader/dist/runtime/styleTagTransform.js"),styleTagTransform_default=__webpack_require__.n(styleTagTransform),NameChangeModal_module=__webpack_require__("./node_modules/@storybook/nextjs/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[15].use[1]!./node_modules/postcss-loader/dist/cjs.js!./node_modules/resolve-url-loader/index.js!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[15].use[4]!./components/modals/NameChangeModal/NameChangeModal.module.scss"),options={};options.styleTagTransform=styleTagTransform_default(),options.setAttributes=setAttributesWithoutAttributes_default(),options.insert=insertBySelector_default().bind(null,"head"),options.domAPI=styleDomAPI_default(),options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(NameChangeModal_module.A,options);const NameChangeModal_NameChangeModal_module=NameChangeModal_module.A&&NameChangeModal_module.A.locals?NameChangeModal_module.A.locals:void 0,{Option}=es_select.A,UserColor=({color})=>{const style={textAlign:"center",backgroundColor:`var(--theme-color-users-${color})`,width:"100%",height:"100%"};return(0,jsx_runtime.jsx)("div",{style})},NameChangeModal=({closeModal})=>{const{t}=(0,next_export_i18n.Bd)(),currentUser=(0,es.vc)(ClientConfigStore.gN),websocketService=(0,es.vc)(ClientConfigStore.W5),[newName,setNewName]=(0,react.useState)((null==currentUser?void 0:currentUser.displayName)||"");if(!currentUser)return null;const{displayName,displayColor}=currentUser,handleNameChange=()=>{if(!newName||!displayName)return;const validation=validateDisplayName(newName,displayName,30);if(!validation.isValid||!(null==websocketService?void 0:websocketService.isConnected()))return;const nameChange={type:socket_events.G.NAME_CHANGE,newName:validation.trimmedName};websocketService.send(nameChange),closeModal()},colorOptions=[...Array(8)].map((_,i)=>i),placeholderText=t(localization.G.Frontend.NameChangeModal.placeholder)||"Your chat display name",validation=validateDisplayName(newName,displayName,30),saveButton=(0,jsx_runtime.jsx)(es_button.A,{type:"primary",id:"name-change-submit",onClick:handleNameChange,disabled:!(()=>{if(!newName||!displayName)return!1;return validateDisplayName(newName,displayName,30).isValid&&(null==websocketService?void 0:websocketService.isConnected())})(),children:(0,jsx_runtime.jsx)(Translation.w,{translationKey:localization.G.Frontend.NameChangeModal.buttonText,defaultText:"Change name"})});return(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("div",{id:"owncast-name-change-description-text",children:(0,jsx_runtime.jsx)(Translation.w,{translationKey:localization.G.Frontend.NameChangeModal.description,defaultText:"Your chat display name is what people see when you send chat messages."})}),(0,jsx_runtime.jsxs)(es_form.A,{onSubmitCapture:handleNameChange,className:NameChangeModal_NameChangeModal_module.form,children:[(0,jsx_runtime.jsx)(input.A.Search,{enterButton:saveButton,id:"name-change-field",value:newName,onChange:e=>setNewName(e.target.value),placeholder:placeholderText,"aria-label":placeholderText,showCount:{formatter:info=>info.count>30?(0,jsx_runtime.jsx)(Translation.w,{translationKey:localization.G.Frontend.NameChangeModal.overLimit,defaultText:"Over limit"}):""},defaultValue:displayName,className:NameChangeModal_NameChangeModal_module.inputGroup}),!validation.isValid&&validation.errorMessage&&(0,jsx_runtime.jsx)("div",{className:NameChangeModal_NameChangeModal_module.error,children:validation.errorMessage})]}),(0,jsx_runtime.jsx)(es_form.A.Item,{label:(0,jsx_runtime.jsx)(Translation.w,{translationKey:localization.G.Frontend.NameChangeModal.colorLabel,defaultText:"Your Color"}),className:NameChangeModal_NameChangeModal_module.colorChange,children:(0,jsx_runtime.jsx)(es_select.A,{style:{width:120},onChange:color=>{const colorChange={type:socket_events.G.COLOR_CHANGE,newColor:Number(color)};websocketService.send(colorChange)},defaultValue:displayColor.toString(),className:NameChangeModal_NameChangeModal_module.colorDropdown,children:colorOptions.map(e=>(0,jsx_runtime.jsx)(Option,{title:e,children:(0,jsx_runtime.jsx)(UserColor,{color:e,"aria-label":e.toString()})},e.toString()))})}),(0,jsx_runtime.jsx)("div",{id:"owncast-name-change-auth-info-text",children:(0,jsx_runtime.jsx)(Translation.w,{translationKey:localization.G.Frontend.NameChangeModal.authInfo,defaultText:'You can also authenticate an IndieAuth or Fediverse account via the "Authenticate" menu.'})})]})};try{NameChangeModal.displayName="NameChangeModal",NameChangeModal.__docgenInfo={description:"",displayName:"NameChangeModal",props:{closeModal:{defaultValue:null,description:"",name:"closeModal",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["components/modals/NameChangeModal/NameChangeModal.tsx#NameChangeModal"]={docgenInfo:NameChangeModal.__docgenInfo,name:"NameChangeModal",path:"components/modals/NameChangeModal/NameChangeModal.tsx#NameChangeModal"})}catch(__react_docgen_typescript_loader_error){}},"./node_modules/@storybook/nextjs/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[15].use[1]!./node_modules/postcss-loader/dist/cjs.js!./node_modules/resolve-url-loader/index.js!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[15].use[4]!./components/modals/NameChangeModal/NameChangeModal.module.scss":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_storybook_nextjs_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@storybook/nextjs/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_storybook_nextjs_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_storybook_nextjs_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_storybook_nextjs_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@storybook/nextjs/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_storybook_nextjs_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_storybook_nextjs_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".NameChangeModal_inputGroup__7489y .ant-input-affix-wrapper{border-width:2px}.NameChangeModal_inputGroup__7489y .ant-input-show-count-suffix{font-size:11px}.NameChangeModal_inputGroup__7489y .ant-btn-primary{font-weight:600}.NameChangeModal_colorChange__AkRZE{padding-top:8px}.NameChangeModal_colorChange__AkRZE .ant-form-item-label{z-index:1000;margin-bottom:0}.NameChangeModal_colorChange__AkRZE .ant-form-item-label label{font-weight:600}.NameChangeModal_colorDropdown__tJ7mn .ant-select:not(.NameChangeModal_ant-select-customize-input__aRklC) .ant-select-selector{padding-left:0;border-width:2px}","",{version:3,sources:["webpack://./components/modals/NameChangeModal/NameChangeModal.module.scss"],names:[],mappings:"AAOC,4DACC,gBAAA,CAGD,gEACC,cAAA,CAGD,oDACC,eAAA,CAMF,oCACC,eAAA,CAEA,yDACC,YAAA,CACA,eAAA,CAEA,+DACC,eAAA,CAQD,+HACC,cAAA,CACA,gBAAA",sourcesContent:[".nameChangeModal {\n\n\n}\n\n\n.inputGroup {\n\t:global(.ant-input-affix-wrapper) {\n\t\tborder-width: 2px;\n\t}\n\n\t:global(.ant-input-show-count-suffix) {\n\t\tfont-size: 11px;\n\t}\n\n\t:global(.ant-btn-primary) {\n\t\tfont-weight: 600;\n\t}\n\n\n}\n\n.colorChange {\n\tpadding-top: 8px;\n\n\t:global(.ant-form-item-label) {\n\t\tz-index: 1000;\n\t\tmargin-bottom: 0;\n\n\t\tlabel {\n\t\t\tfont-weight: 600;\n\n\t\t}\n\t}\n}\n\n.colorDropdown {\n\t:global(.ant-select):not(.ant-select-customize-input) {\n\t\t:global(.ant-select-selector) {\n\t\t\tpadding-left:0;\n\t\t\tborder-width: 2px;\n\t\t}\n\t}\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={inputGroup:"NameChangeModal_inputGroup__7489y",colorChange:"NameChangeModal_colorChange__AkRZE",colorDropdown:"NameChangeModal_colorDropdown__tJ7mn","ant-select-customize-input":"NameChangeModal_ant-select-customize-input__aRklC"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___}}]);