(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2306],{2306:function(e,t,n){"use strict";n.r(t),n.d(t,{UserDropdown:function(){return _}});var r=n(85893),o=n(70449),a=n(56469),i=n(93967),s=n.n(i),l=n(4480),c=n(67294),d=n(20927),u=n(5152),p=n.n(u),h=n(4511),m=n(28049),f=n(29223),y=n.n(f),b=n(69583);let w=p()(()=>Promise.all([n.e(3247),n.e(9036)]).then(n.t.bind(n,9036,23)),{loadableGenerated:{webpack:()=>[9036]},ssr:!1}),g=p()(()=>Promise.all([n.e(3247),n.e(3181)]).then(n.t.bind(n,93181,23)),{loadableGenerated:{webpack:()=>[93181]},ssr:!1}),k=p()(()=>Promise.all([n.e(3247),n.e(9712)]).then(n.t.bind(n,49712,23)),{loadableGenerated:{webpack:()=>[49712]},ssr:!1}),v=p()(()=>Promise.all([n.e(3247),n.e(795)]).then(n.t.bind(n,30795,23)),{loadableGenerated:{webpack:()=>[30795]},ssr:!1}),E=p()(()=>Promise.all([n.e(3247),n.e(3632)]).then(n.t.bind(n,43632,23)),{loadableGenerated:{webpack:()=>[43632]},ssr:!1}),L=p()(()=>Promise.all([n.e(3247),n.e(604)]).then(n.t.bind(n,50604,23)),{loadableGenerated:{webpack:()=>[50604]},ssr:!1}),C=p()(()=>Promise.all([n.e(3247),n.e(6681)]).then(n.t.bind(n,96681,23)),{loadableGenerated:{webpack:()=>[96681]},ssr:!1}),S=p()(()=>Promise.all([n.e(9675),n.e(1287),n.e(7786),n.e(4955)]).then(n.bind(n,4955)).then(e=>e.Modal),{loadableGenerated:{webpack:()=>[4955]},ssr:!1}),x=p()(()=>Promise.all([n.e(7561),n.e(83),n.e(1287),n.e(9904),n.e(7528),n.e(9023)]).then(n.bind(n,90666)).then(e=>e.NameChangeModal),{loadableGenerated:{webpack:()=>[90666]},ssr:!1}),P=p()(()=>Promise.all([n.e(6030),n.e(83),n.e(1287),n.e(3657),n.e(9307),n.e(9671),n.e(5042)]).then(n.bind(n,65042)).then(e=>e.AuthModal),{loadableGenerated:{webpack:()=>[65042]},ssr:!1}),_=e=>{let{id:t,username:n,hideTitleOnMobile:i=!1,showToggleChatOption:u=!0}=e,[p,f]=(0,c.useState)(!1),[_,A]=(0,c.useState)(!1),[j,G]=(0,l.FV)(m.vZ),[D,I]=(0,c.useState)(null),K=(0,l.sJ)(m.Q),N=()=>{u&&G(j===m.gG.VISIBLE?m.gG.HIDDEN:m.gG.VISIBLE)},O=()=>{f(!1)},T=()=>{D&&D.close(),I(null),G(m.gG.VISIBLE)},M=u&&K.chatAvailable&&(j===m.gG.HIDDEN||j===m.gG.VISIBLE),R=u&&K.chatAvailable&&(j===m.gG.HIDDEN||j===m.gG.VISIBLE||j===m.gG.POPPED_OUT);(0,d.y1)("c",N,{enableOnContentEditable:!1},[j===m.gG.VISIBLE]);let U=(0,l.sJ)(m.db);if(!U)return null;let{displayName:V}=U,q=[{key:0,icon:(0,r.jsx)(g,{}),label:"Change name",onClick:()=>{f(!0)}},{key:1,icon:(0,r.jsx)(k,{}),label:"Authenticate",onClick:()=>A(!0)}];return M&&q.push({key:3,"aria-expanded":j===m.gG.VISIBLE,className:y().chatToggle,icon:(0,r.jsx)(L,{}),label:j===m.gG.VISIBLE?"Hide Chat (c)":"Show Chat (c)",onClick:N}),R&&q.push({key:4,icon:D?(0,r.jsx)(v,{}):(0,r.jsx)(E,{}),label:D?"Put chat back":"Pop out chat",onClick:D?T:()=>{T();let e=window.open("/embed/chat/readwrite","_blank","popup");e.addEventListener("beforeunload",T),I(e),G(m.gG.POPPED_OUT)}}),(0,r.jsx)(h.SV,{fallbackRender:e=>{let{error:t,resetErrorBoundary:n}=e;return(0,r.jsx)(b.A,{componentName:"UserDropdown",message:t.message,retryFunction:n})},children:(0,r.jsxs)("div",{className:y().root,children:[(0,r.jsx)(o.Z,{menu:{items:q},trigger:["click"],children:(0,r.jsxs)(a.Z,{id:t,type:"primary",icon:(0,r.jsx)(C,{className:y().userIcon}),children:[(0,r.jsx)("span",{className:s()([y().username,i&&y().hideTitleOnMobile]),children:n||V}),(0,r.jsx)(w,{})]})}),(0,r.jsx)(S,{title:"Change Chat Display Name",open:p,handleCancel:O,children:(0,r.jsx)(x,{closeModal:O})}),(0,r.jsx)(S,{title:"Authenticate",open:_,handleCancel:()=>A(!1),children:(0,r.jsx)(P,{})})]})})}},29223:function(e){e.exports={root:"UserDropdown_root__XCKtE","ant-space":"UserDropdown_ant-space__NT8a9","ant-space-item":"UserDropdown_ant-space-item__D6AUQ",username:"UserDropdown_username__1vJf_",hideTitleOnMobile:"UserDropdown_hideTitleOnMobile__Nd7fp",chatToggle:"UserDropdown_chatToggle__MEP4e"}},20927:function(e,t,n){"use strict";n.d(t,{y1:function(){return L}});var r=n(67294);n(85893);let o=["shift","alt","meta","mod","ctrl","control"],a={esc:"escape",return:"enter",left:"arrowleft",right:"arrowright",up:"arrowup",down:"arrowdown",ShiftLeft:"shift",ShiftRight:"shift",AltLeft:"alt",AltRight:"alt",MetaLeft:"meta",MetaRight:"meta",OSLeft:"meta",OSRight:"meta",ControlLeft:"ctrl",ControlRight:"ctrl"};function i(e){return(a[e.trim()]||e.trim()).toLowerCase().replace(/key|digit|numpad/,"")}function s(e){return o.includes(e)}function l(e,t=","){return e.toLowerCase().split(t)}function c(e,t="+",n=">",r=!1,a){let s=[],l=!1;(e=e.trim()).includes(n)?(l=!0,s=e.toLocaleLowerCase().split(n).map(e=>i(e))):s=e.toLocaleLowerCase().split(t).map(e=>i(e));let c={alt:s.includes("alt"),ctrl:s.includes("ctrl")||s.includes("control"),shift:s.includes("shift"),meta:s.includes("meta"),mod:s.includes("mod"),useKey:r},d=s.filter(e=>!o.includes(e));return{...c,keys:d,description:a,isSequence:l,hotkey:e}}"u">typeof document&&(document.addEventListener("keydown",e=>{void 0!==e.code&&p([i(e.code)])}),document.addEventListener("keyup",e=>{void 0!==e.code&&h([i(e.code)])})),"u">typeof window&&(window.addEventListener("blur",()=>{d.clear()}),window.addEventListener("contextmenu",()=>{setTimeout(()=>{d.clear()},0)}));let d=new Set;function u(e){return Array.isArray(e)}function p(e){let t=Array.isArray(e)?e:[e];d.has("meta")&&d.forEach(e=>!s(e)&&d.delete(e.toLowerCase())),t.forEach(e=>d.add(e.toLowerCase()))}function h(e){let t=Array.isArray(e)?e:[e];"meta"===e?d.clear():t.forEach(e=>d.delete(e.toLowerCase()))}let m=["input","textarea","select","searchbox","slider","spinbutton","menuitem","menuitemcheckbox","menuitemradio","option","radio","textbox"];function f(e,t=!1){let n,r;let{target:o,composed:a}=e;return o.tagName&&!o.tagName.startsWith("-")&&o.tagName.includes("-")&&a?(n=e.composedPath()[0]&&e.composedPath()[0].tagName,r=e.composedPath()[0]&&e.composedPath()[0].role):(n=o&&o.tagName,r=o&&o.role),u(t)?!!(n&&t&&t.some(e=>e.toLowerCase()===n.toLowerCase()||e===r)):!!(n&&t&&t)}let y=(e,t,n=!1)=>{let{alt:r,meta:o,mod:a,shift:s,ctrl:l,keys:c,useKey:p}=t,{code:h,key:m,ctrlKey:f,metaKey:y,shiftKey:b,altKey:w}=e,g=i(h);if(p&&c?.length===1&&c.includes(m))return!0;if(!c?.includes(g)&&!["ctrl","control","unknown","meta","alt","shift","os"].includes(g))return!1;if(!n){if(r!==w&&"alt"!==g||s!==b&&"shift"!==g)return!1;if(a){if(!y&&!f)return!1}else if(o!==y&&"meta"!==g&&"os"!==g||l!==f&&"ctrl"!==g&&"control"!==g)return!1}return!!(c&&1===c.length&&c.includes(g))||(c?function(e,t=","){return(u(e)?e:e.split(t)).every(e=>d.has(e.trim().toLowerCase()))}(c):!c)},b=(0,r.createContext)(void 0),w=()=>(0,r.useContext)(b),g=(0,r.createContext)({hotkeys:[],activeScopes:[],toggleScope:()=>{},enableScope:()=>{},disableScope:()=>{}}),k=()=>(0,r.useContext)(g),v=e=>{e.stopPropagation(),e.preventDefault(),e.stopImmediatePropagation()},E="u">typeof window?r.useLayoutEffect:r.useEffect;function L(e,t,n,o){let a=(0,r.useRef)(null),d=(0,r.useRef)(!1),b=Array.isArray(n)?Array.isArray(o)?void 0:o:n,g=u(e)?e.join(b?.delimiter):e,L=Array.isArray(n)?n:Array.isArray(o)?o:void 0,C=(0,r.useCallback)(t,L??[]),S=(0,r.useRef)(C);L?S.current=C:S.current=t;let x=function(e){let t=(0,r.useRef)(void 0);return function e(t,n){return t&&n&&"object"==typeof t&&"object"==typeof n?Object.keys(t).length===Object.keys(n).length&&Object.keys(t).reduce((r,o)=>r&&e(t[o],n[o]),!0):t===n}(t.current,e)||(t.current=e),t.current}(b),{activeScopes:P}=k(),_=w();return E(()=>{var e;if(x?.enabled===!1||(e=x?.scopes,0===P.length&&e?(console.warn('A hotkey has the "scopes" option set, however no active scopes were found. If you want to use the global scopes feature, you need to wrap your app in a <HotkeysProvider>'),!1):!(!e||P.some(t=>e.includes(t))||P.includes("*"))))return;let t=[],n,r=(e,r=!1)=>{if(!(f(e,m)&&!f(e,x?.enableOnFormTags))){if(null!==a.current){let t=a.current.getRootNode();if((t instanceof Document||t instanceof ShadowRoot)&&t.activeElement!==a.current&&!a.current.contains(t.activeElement)){v(e);return}}e.target?.isContentEditable&&!x?.enableOnContentEditable||l(g,x?.delimiter).forEach(o=>{if(o.includes(x?.splitKey??"+")&&o.includes(x?.sequenceSplitKey??">")){console.warn(`Hotkey ${o} contains both ${x?.splitKey??"+"} and ${x?.sequenceSplitKey??">"} which is not supported.`);return}let a=c(o,x?.splitKey,x?.sequenceSplitKey,x?.useKey,x?.description);if(a.isSequence){n=setTimeout(()=>{t=[]},x?.sequenceTimeoutMs??1e3);let r=a.useKey?e.key:i(e.code);if(s(r.toLowerCase()))return;if(t.push(r),r!==a.keys?.[t.length-1]){t=[],n&&clearTimeout(n);return}t.length===a.keys?.length&&(S.current(e,a),n&&clearTimeout(n),t=[])}else if(y(e,a,x?.ignoreModifiers)||a.keys?.includes("*")){var l,u;if(x?.ignoreEventWhen?.(e)||r&&d.current)return;if(("function"==typeof(l=x?.preventDefault)&&l(e,a)||!0===l)&&e.preventDefault(),"function"==typeof(u=x?.enabled)?!u(e,a):!0!==u&&void 0!==u){v(e);return}S.current(e,a),r||(d.current=!0)}})}},o=e=>{void 0!==e.code&&(p(i(e.code)),(x?.keydown===void 0&&x?.keyup!==!0||x?.keydown)&&r(e))},u=e=>{void 0!==e.code&&(h(i(e.code)),d.current=!1,x?.keyup&&r(e,!0))},w=a.current||b?.document||document;return w.addEventListener("keyup",u,b?.eventListenerOptions),w.addEventListener("keydown",o,b?.eventListenerOptions),_&&l(g,x?.delimiter).forEach(e=>_.addHotkey(c(e,x?.splitKey,x?.sequenceSplitKey,x?.useKey,x?.description))),()=>{w.removeEventListener("keyup",u,b?.eventListenerOptions),w.removeEventListener("keydown",o,b?.eventListenerOptions),_&&l(g,x?.delimiter).forEach(e=>_.removeHotkey(c(e,x?.splitKey,x?.sequenceSplitKey,x?.useKey,x?.description))),t=[],n&&clearTimeout(n)}},[g,x,P]),a}}}]);