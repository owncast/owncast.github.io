(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6109],{92794:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/viewer-info",function(){return n(65874)}])},31112:function(e,t,n){"use strict";n.d(t,{k:function(){return d}});var r=n(85893),a=n(12642),i=n(67294),s=n(71218),l=n(23148),o=n(26495),u=n(56469);function c(e){let t={};return e.forEach(e=>{let n=new Date(e.time);t[(0,a.WU)(n,"H:mma")]=e.value}),t}l.kL.register(l.uw,l.WV,l.f$,l.od,l.jn,l.Dx,l.u,l.De);let d=e=>{let{data:t,title:n,color:a,unit:l,dataCollections:d,yFlipped:f,yLogarithmic:h,minYValue:x,yStepSize:p=0}=e,m=[],g=(0,i.useRef)(null);return t&&t.length>0&&m.push({id:n,label:n,backgroundColor:a,borderColor:a,borderWidth:3,data:c(t)}),d.forEach(e=>{m.push({id:e.name,label:e.name,data:c(e.data),backgroundColor:e.color,borderColor:e.color,borderWidth:3,pointStyle:e.pointStyle||"circle",radius:e.pointRadius||1})}),(0,r.jsxs)("div",{className:"line-chart-container",children:[(0,r.jsx)(o.x1,{ref:g,data:{datasets:m},options:{responsive:!0,clip:!1,scales:{y:{type:h?"logarithmic":"linear",reverse:f,min:x,ticks:{stepSize:p},title:{display:!0,text:l}}}},height:"70vh"}),(0,r.jsx)(u.Z,{size:"small",onClick:()=>{if(g.current){let e=document.createElement("a");e.download="chart.png",e.href=g.current.canvas.toDataURL(),e.click()}},type:"ghost",icon:(0,r.jsx)(s.Z,{}),className:"download-btn"})]})};d.defaultProps={dataCollections:[],data:[],title:"",yFlipped:!1,yLogarithmic:!1}},26826:function(e,t,n){"use strict";n.d(t,{m:function(){return h}});var r=n(85893),a=n(23657),i=n(92120),s=n(75543),l=n(3816);let{Text:o}=a.default,u={title:"",value:0,prefix:null,suffix:null,color:"",progress:!1,centered:!1,formatter:null},c=e=>{let{prefix:t,value:n,suffix:a,title:i}=e;return(0,r.jsxs)("div",{children:[t,(0,r.jsx)("div",{children:(0,r.jsx)(o,{type:"secondary",children:i})}),(0,r.jsx)("div",{children:(0,r.jsxs)(o,{type:"secondary",children:[n,a||"%"]})})]})},d=e=>{let{title:t,value:n,prefix:a,suffix:s,color:l}=e,o=n>90?"red":l,u=(0,r.jsx)(c,{prefix:a,value:n,suffix:s,title:t});return(0,r.jsx)(i.Z,{type:"dashboard",percent:n,width:120,strokeColor:{"0%":l,"90%":o},format:()=>u})};d.defaultProps=u;let f=e=>{let{title:t,value:n,prefix:a,formatter:i}=e;return(0,r.jsx)(s.Z,{title:t,value:n,prefix:a,formatter:i})};f.defaultProps=u;let h=e=>{let{progress:t,centered:n}=e,a=t?d:f;return(0,r.jsx)(l.default,{type:"inner",children:(0,r.jsx)("div",{style:n?{display:"flex",alignItems:"center",justifyContent:"center"}:{},children:(0,r.jsx)(a,{...e})})})};h.defaultProps=u},23061:function(e,t,n){"use strict";var r=n(67294),a=n(64773),i=n(98947);t.Z=function(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=(0,r.useRef)({}),n=(0,a.Z)();return(0,r.useEffect)(function(){var r=i.ZP.subscribe(function(r){t.current=r,e&&n()});return function(){return i.ZP.unsubscribe(r)}},[]),t.current}},65874:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return E}});var r=n(85893),a=n(67294),i=n(23657),s=n(10227),l=n(78021),o=n(1461),u=n(93879),c=n(70449),d=n(16393),f=n(6916),h=n(32532);function x(e,t,n){var r,a,i;let{years:s=0,months:l=0,weeks:o=0,days:u=0,hours:c=0,minutes:x=0,seconds:p=0}=t,m=(r=l+12*s,a=(0,h.z)(e,-r,n),i=u+7*o,(0,f.E)(a,-i,n));return(0,d.L)((null==n?void 0:n.in)||e,+m-1e3*(p+60*(x+60*c)))}var p=n(46042),m=n(5152),g=n.n(m),v=n(37039),j=n(31112),w=n(26826),y=n(27043),b=n(61913),k=n(74040);let S=e=>{let{data:t}=e;return(0,r.jsx)(y.Z,{pagination:{hideOnSinglePage:!0},className:"table-container",columns:[{title:"User Agent",dataIndex:"userAgent",key:"userAgent",render:e=>(0,k.AB)(e)},{title:"Location",dataIndex:"geo",key:"geo",render:e=>e?"".concat(e.regionName,", ").concat(e.countryCode):"-"},{title:"Watch Time",dataIndex:"firstSeen",key:"firstSeen",defaultSortOrder:"ascend",render:e=>(0,b.Q)(new Date(e)),sorter:(e,t)=>new Date(e.firstSeen).getTime()-new Date(t.firstSeen).getTime(),sortDirections:["descend","ascend"]}],dataSource:t,size:"small",rowKey:"id"})};var D=n(4481),N=n(11992),Z=n(25889);let C=g()(()=>Promise.all([n.e(3247),n.e(5746)]).then(n.t.bind(n,75746,23)),{loadableGenerated:{webpack:()=>[75746]},ssr:!1}),L=g()(()=>Promise.all([n.e(3247),n.e(6681)]).then(n.t.bind(n,96681,23)),{loadableGenerated:{webpack:()=>[96681]},ssr:!1});function E(){let e;let t=(0,a.useContext)(D.a),{t:n}=(0,v.$G)(),{online:d,broadcaster:f,viewerCount:h,overallPeakViewerCount:m,sessionPeakViewerCount:g}=t||{};f&&f.time&&(e=new Date(f.time));let y=[{title:n("Current stream"),start:e},{title:n("Last 12 hours"),start:x(new Date,{hours:12})},{title:n("Last 24 hours"),start:x(new Date,{hours:24})},{title:n("Last 7 days"),start:x(new Date,{days:7})},{title:n("Last 30 days"),start:x(new Date,{days:30})},{title:n("Last 3 months"),start:x(new Date,{months:3})},{title:n("Last 6 months"),start:x(new Date,{months:6})}],[b,k]=(0,a.useState)(!0),[Z,E]=(0,a.useState)([]),[_,P]=(0,a.useState)([]),[T,I]=(0,a.useState)(y[1]),z=async()=>{try{var e;let t="".concat(N.iV,"?windowStart=").concat((e=T.start,Math.trunc(+(0,p.Q)(e)/1e3))),n=await (0,N.rQ)(t);E(n),k(!1)}catch(e){console.log("==== error",e)}try{let e=await (0,N.rQ)(N.a_);P(e)}catch(e){console.log("==== error",e)}};(0,a.useEffect)(()=>{let e=null;return(z(),d)?(e=setInterval(z,6e4),()=>{clearInterval(e)}):()=>[]},[d,T]);let M=e=>{let{key:t}=e;I(y[t])},Q=d&&e?0:1,V=y.slice(Q).map((e,t)=>({key:t+Q,label:e.title,onClick:M}));return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.default.Title,{children:n("Viewer Info")}),(0,r.jsx)("br",{}),(0,r.jsxs)(s.Z,{gutter:[16,16],justify:"space-around",children:[d&&(0,r.jsx)(l.Z,{span:8,md:8,children:(0,r.jsx)(w.m,{title:n("Current viewers"),value:h.toString(),prefix:(0,r.jsx)(L,{})})}),(0,r.jsx)(l.Z,{md:d?8:12,children:(0,r.jsx)(w.m,{title:n(d?"Max viewers this stream":"Max viewers last stream"),value:g.toString(),prefix:(0,r.jsx)(L,{})})}),(0,r.jsx)(l.Z,{md:d?8:12,children:(0,r.jsx)(w.m,{title:n("max viewers"),value:m.toString(),prefix:(0,r.jsx)(L,{})})})]}),!Z.length&&(0,r.jsx)(o.Z,{style:{marginTop:"10px"},banner:!0,message:n("Please wait"),description:n("No viewer data has been collected yet."),type:"info"}),(0,r.jsxs)(u.Z,{spinning:!Z.length||b,children:[Z.length>0&&(0,r.jsx)(j.k,{title:n("Viewers"),data:Z,color:"#2087E2",unit:"viewers",minYValue:0,yStepSize:1}),(0,r.jsx)(c.Z,{menu:{items:V},trigger:["click"],children:(0,r.jsxs)("button",{type:"button",style:{position:"absolute",top:"5px",right:"35px",background:"transparent",border:"unset"},children:[T.title," ",(0,r.jsx)(C,{})]})}),(0,r.jsx)(S,{data:_})]})]})}E.getLayout=function(e){return(0,r.jsx)(Z.l,{page:e})}},6916:function(e,t,n){"use strict";n.d(t,{E:function(){return i}});var r=n(16393),a=n(46042);function i(e,t,n){let i=(0,a.Q)(e,null==n?void 0:n.in);return isNaN(t)?(0,r.L)((null==n?void 0:n.in)||e,NaN):(t&&i.setDate(i.getDate()+t),i)}},32532:function(e,t,n){"use strict";n.d(t,{z:function(){return i}});var r=n(16393),a=n(46042);function i(e,t,n){let i=(0,a.Q)(e,null==n?void 0:n.in);if(isNaN(t))return(0,r.L)((null==n?void 0:n.in)||e,NaN);if(!t)return i;let s=i.getDate(),l=(0,r.L)((null==n?void 0:n.in)||e,i.getTime());return(l.setMonth(i.getMonth()+t+1,0),s>=l.getDate())?l:(i.setFullYear(l.getFullYear(),l.getMonth(),s),i)}}},function(e){e.O(0,[2196,83,1287,8920,7786,443,9904,3657,2502,3093,7528,9532,449,7043,7039,4065,9307,2642,1913,6179,297,3550,5889,3064,2888,9774,179],function(){return e(e.s=92794)}),_N_E=e.O()}]);