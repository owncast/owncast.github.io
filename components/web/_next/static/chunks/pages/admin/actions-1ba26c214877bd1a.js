(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5685],{54005:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/actions",function(){return n(49783)}])},49783:function(e,t,n){"use strict";n.r(t);var l=n(85893),a=n(23657),r=n(77786),o=n(73211),i=n(87528),s=n(20133),u=n(72370),d=n(4116),c=n(56469),h=n(27043),p=n(11106),x=n(58909),m=n(82261),f=n(5152),j=n.n(f),y=n(67294),v=n(17586),g=n(70869),k=n(28700),b=n(4481),w=n(11),C=n(25889);let{Title:I,Paragraph:S}=a.default,E=j()(()=>Promise.all([n.e(3247),n.e(1506)]).then(n.t.bind(n,81506,23)),{loadableGenerated:{webpack:()=>[81506]},ssr:!1}),T=j()(()=>Promise.all([n.e(3247),n.e(3181)]).then(n.t.bind(n,93181,23)),{loadableGenerated:{webpack:()=>[93181]},ssr:!1}),_=e=>{let{onOk:t,onCancel:n,open:a,action:d}=e,[c,h]=(0,y.useState)("url"),[f,j]=(0,y.useState)(""),[v,g]=(0,y.useState)(""),[k,b]=(0,y.useState)(""),[C,I]=(0,y.useState)(""),[S,E]=(0,y.useState)(""),[T,_]=(0,y.useState)(""),[O,L]=(0,y.useState)(!1);(0,y.useEffect)(()=>{var e;h(((null==d?void 0:null===(e=d.html)||void 0===e?void 0:e.length)||0)>0?"html":"url"),j((null==d?void 0:d.url)||""),g((null==d?void 0:d.html)||""),b((null==d?void 0:d.title)||""),I((null==d?void 0:d.description)||""),E((null==d?void 0:d.icon)||""),_((null==d?void 0:d.color)||""),L((null==d?void 0:d.openExternally)||!1)},[d]);let N={disabled:!("html"===c?""!==v&&""!==k:(0,w.jv)(f,["https:"])&&""!==k)};return(0,l.jsx)(r.default,{destroyOnClose:!0,title:null==d?"Create New Action":"Edit Action",open:a,onOk:function(){t(d,e.index,"html"===c?"":f,"html"===c?v:"",k,C,S,T,O),j(""),g(""),b(""),I(""),E(""),_(""),L(!1)},onCancel:n,okButtonProps:N,children:(0,l.jsxs)(o.default,{initialValues:d,children:["Add the URL for the external action you want to present."," ",(0,l.jsx)("strong",{children:"Only HTTPS URLs and embeds are supported."}),(0,l.jsx)("p",{children:(0,l.jsx)("a",{href:"https://owncast.online/thirdparty/actions/",target:"_blank",rel:"noopener noreferrer",children:"Read more about external actions."})}),(0,l.jsx)(o.default.Item,{children:(0,l.jsx)(i.default,{value:c,onChange:h,placeholder:"Select an action type",options:[{label:"Link or embed an URL",value:"url"},{label:"Custom HTML",value:"html"}]})}),"html"===c?(0,l.jsx)(o.default.Item,{name:"html",children:(0,l.jsx)(p.ZP,{value:v,placeholder:"HTML embed code (required)",theme:x.FZ,height:"200px",extensions:[(0,m.html)()],onChange:e=>{g(e)}})}):(0,l.jsx)(o.default.Item,{name:"url",children:(0,l.jsx)(s.default,{required:!0,placeholder:"https://myserver.com/action (required)",onChange:e=>j(e.currentTarget.value.trim()),type:"url",pattern:w.ax})}),(0,l.jsx)(o.default.Item,{name:"title",children:(0,l.jsx)(s.default,{value:k,required:!0,placeholder:"Your action title (required)",onChange:e=>b(e.currentTarget.value)})}),(0,l.jsx)(o.default.Item,{name:"description",children:(0,l.jsx)(s.default,{value:C,placeholder:"Optional description",onChange:e=>I(e.currentTarget.value)})}),(0,l.jsx)(o.default.Item,{name:"icon",children:(0,l.jsx)(s.default,{value:S,placeholder:"https://myserver.com/action/icon.png (optional)",onChange:e=>E(e.currentTarget.value)})}),(0,l.jsxs)("div",{children:[(0,l.jsx)(o.default.Item,{name:"color",style:{marginBottom:"0px"},children:(0,l.jsx)(s.default,{type:"color",value:T,onChange:e=>_(e.currentTarget.value)})}),"Optional background color of the action button."]}),"html"===c?null:(0,l.jsx)(o.default.Item,{name:"openExternally",children:(0,l.jsx)(u.Z,{checked:O,defaultChecked:O,onChange:e=>{L(e.target.checked)},children:"Open in a new tab instead of within your page."})})]})})},O=()=>{let{serverConfig:e,setFieldInConfigState:t}=(0,y.useContext)(b.a)||{},{externalActions:n}=e,[a,r]=(0,y.useState)(null),[o,i]=(0,y.useState)(!1),[s,u]=(0,y.useState)(null),[p,x]=(0,y.useState)(null),[m,f]=(0,y.useState)(-1),j=()=>{u(null),clearTimeout(null)};async function w(e){await (0,g.Si)({apiPath:g.os,data:{value:e},onSuccess:()=>{t({fieldName:"externalActions",value:e,path:""}),u((0,k.kg)(k.zv,"Updated.")),setTimeout(j,g.sI)},onError:e=>{console.log(e),u((0,k.kg)(k.Un,e)),setTimeout(j,g.sI)}})}async function C(e){let t=[...a];t.splice(e,1);try{r(t),w(t)}catch(e){console.error(e)}}async function O(e,t,n,l,o,i,s,u,d){try{let e=[...a],c={url:n,html:l,title:o,description:i,icon:s,color:u,openExternally:d};t>=0?e[t]=c:e.push(c),r(e),await w(e)}catch(e){console.error(e)}}async function L(e,t){f(t),x(e),i(!0)}(0,y.useEffect)(()=>{r(n||[])},[n]);let N=[{title:"",key:"delete-edit",render:(e,t,n)=>(0,l.jsxs)(d.Z,{size:"middle",children:[(0,l.jsx)(c.Z,{onClick:()=>C(n),icon:(0,l.jsx)(E,{})}),(0,l.jsx)(c.Z,{onClick:()=>L(t,n),icon:(0,l.jsx)(T,{})})]})},{title:"Name",dataIndex:"title",key:"title"},{title:"Description",dataIndex:"description",key:"description"},{title:"URL / Embed",key:"url",dataIndex:"url",render:(e,t)=>t.html?"HTML embed":t.url},{title:"Icon",dataIndex:"icon",key:"icon",render:e=>e?(0,l.jsx)("img",{style:{width:"2vw"},src:e,alt:""}):null},{title:"Color",dataIndex:"color",key:"color",render:e=>e?(0,l.jsx)("div",{style:{backgroundColor:e,height:"30px"},children:e}):null},{title:"Opens",key:"openExternally",dataIndex:"openExternally",render:(e,t)=>!e||t.html?"In the same tab":"In a new tab"}];return(0,l.jsxs)("div",{children:[(0,l.jsx)(I,{children:"External Actions"}),(0,l.jsx)(S,{children:"External action URLs are 3rd party UI you can display, embedded, into your Owncast page when a user clicks on a button to launch your action."}),(0,l.jsxs)(S,{children:["Read more about how to use actions, with examples, at"," ",(0,l.jsx)("a",{href:"https://owncast.online/thirdparty/?source=admin",target:"_blank",rel:"noopener noreferrer",children:"our documentation"}),"."]}),(0,l.jsx)(h.Z,{rowKey:e=>"".concat(e.title,"-").concat(e.url),columns:N,dataSource:a,pagination:!1}),(0,l.jsx)("br",{}),(0,l.jsx)(c.Z,{type:"primary",onClick:()=>{x(null),f(-1),i(!0)},children:"Create New Action"}),(0,l.jsx)(v.E,{status:s}),(0,l.jsx)(_,{action:p,index:m,open:o,onOk:(e,t,n,l,a,r,o,s,u)=>{i(!1),O(e,t,n,l,a,r,o,s,u),x(null),f(-1)},onCancel:()=>{i(!1)}})]})};O.getLayout=function(e){return(0,l.jsx)(C.l,{page:e})},t.default=O}},function(e){e.O(0,[5762,83,1287,8920,7786,443,9904,3657,2502,3093,7528,9532,449,7043,2575,5889,2888,9774,179],function(){return e(e.s=54005)}),_N_E=e.O()}]);