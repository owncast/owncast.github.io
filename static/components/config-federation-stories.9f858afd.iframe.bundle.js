"use strict";(self.webpackChunkowncast_web=self.webpackChunkowncast_web||[]).push([[6677,7604],{"./stories/config-federation.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>config_federation_stories});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),modal=__webpack_require__("./node_modules/antd/es/modal/index.js"),es_button=__webpack_require__("./node_modules/antd/es/button/index.js"),typography=__webpack_require__("./node_modules/antd/es/typography/index.js"),es_alert=__webpack_require__("./node_modules/antd/es/alert/index.js"),row=__webpack_require__("./node_modules/antd/es/row/index.js"),col=__webpack_require__("./node_modules/antd/es/col/index.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),es_form=__webpack_require__("./node_modules/antd/es/form/index.js"),input=__webpack_require__("./node_modules/antd/es/input/index.js"),input_number=__webpack_require__("./node_modules/antd/es/input-number/index.js");const FormStatusIndicator=({status})=>{const{type,icon,message}=status||{},classes=classnames_default()({"status-container":!0,[`status-${type}`]:type,empty:!message});return(0,jsx_runtime.jsxs)("span",{className:classes,children:[icon?(0,jsx_runtime.jsx)("span",{className:"status-icon",children:icon}):null,message?(0,jsx_runtime.jsx)("span",{className:"status-message",children:message}):null]})};try{FormStatusIndicator.displayName="FormStatusIndicator",FormStatusIndicator.__docgenInfo={description:"",displayName:"FormStatusIndicator",props:{status:{defaultValue:null,description:"",name:"status",required:!0,type:{name:"StatusState"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["components/admin/FormStatusIndicator.tsx#FormStatusIndicator"]={docgenInfo:FormStatusIndicator.__docgenInfo,name:"FormStatusIndicator",path:"components/admin/FormStatusIndicator.tsx#FormStatusIndicator"})}catch(__react_docgen_typescript_loader_error){}var apis=__webpack_require__("./utils/apis.ts"),validators=__webpack_require__("./utils/validators.ts");async function postConfigUpdateToAPI(args){const{apiPath,data,onSuccess,onError}=args;try{const result=await(0,apis.Fd)(`${apis.nn}${apiPath}`,{data,method:"POST",auth:!0});result.success&&onSuccess?onSuccess(result.message):onError&&onError(result.message)}catch(e){onError&&onError(e.message)}}const TEXTFIELD_PROPS_STREAM_TITLE={apiPath:"/streamtitle",configPath:"instanceDetails",maxLength:100,placeholder:"Doing cool things...",label:"Stream Title",tip:"What is your stream about today?"},FIELD_PROPS_ENABLE_FEDERATION=(validators.vI,validators.vI,validators.vI,{apiPath:"/federation/enable",configPath:"federation",label:"Enable Social Features",tip:"Send and receive activities on the Fediverse.",useSubmit:!0}),FIELD_PROPS_FEDERATION_IS_PRIVATE={apiPath:"/federation/private",configPath:"federation",label:"Private",tip:"Follow requests will require approval and only followers will see your activity.",useSubmit:!0},FIELD_PROPS_SHOW_FEDERATION_ENGAGEMENT={apiPath:"/federation/showengagement",configPath:"showEngagement",label:"Show engagement",tip:"Following, liking and sharing will appear in the chat feed.",useSubmit:!0},TEXTFIELD_PROPS_FEDERATION_LIVE_MESSAGE={apiPath:"/federation/livemessage",configPath:"federation",maxLength:500,placeholder:"My stream has started, tune in!",label:"Now Live message",tip:"The message sent announcing that your live stream has begun. Tags will be automatically added. Leave blank to disable."},TEXTFIELD_PROPS_FEDERATION_DEFAULT_USER={apiPath:"/federation/username",configPath:"federation",maxLength:10,placeholder:"owncast",default:"owncast",label:"Username",tip:'The username used for sending and receiving activities from the Fediverse. For example, if you use "bob" as a username you would send messages to the fediverse from @bob@yourserver. Once people start following your instance you should not change this.\nNote: Username cannot have special characters. '},TEXTFIELD_PROPS_FEDERATION_INSTANCE_URL={apiPath:"/serverurl",configPath:"yp",maxLength:255,placeholder:"https://owncast.mysite.com",label:"Server URL",tip:"The full url to your Owncast server is required to enable social features. Must use SSL (https). Once people start following your instance you should not change this.",type:"url",pattern:validators.vI,useTrim:!0},FIELD_PROPS_FEDERATION_NSFW={apiPath:"/nsfw",configPath:"instanceDetails",label:"Potentially NSFW",tip:"Turn this ON if you plan to stream explicit or adult content so previews of your stream can be marked as potentially sensitive."},FIELD_PROPS_FEDERATION_BLOCKED_DOMAINS_label="Blocked domains",FIELD_PROPS_FEDERATION_BLOCKED_DOMAINS_placeholder="bad.domain.biz",FIELD_PROPS_FEDERATION_BLOCKED_DOMAINS_tip="You can block specific domains from interacting with you.",PASSWORD_COMPLEXITY_RULES=(validators.vI,validators.vI,[{min:8,message:"- minimum 8 characters"},{max:192,message:"- maximum 192 characters"},{pattern:/^(?=.*[a-z])/,message:"- at least one lowercase letter"},{pattern:/^(?=.*[A-Z])/,message:"- at least one uppercase letter"},{pattern:/\d/,message:"- at least one digit"},{pattern:/^(?=.*?[#?!@$%^&*-])/,message:"- at least one special character: !@#$%^&*"}]),REGEX_PASSWORD=/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[!@#$%^&*]).{8,192}$/;try{postConfigUpdateToAPI.displayName="postConfigUpdateToAPI",postConfigUpdateToAPI.__docgenInfo={description:"",displayName:"postConfigUpdateToAPI",props:{apiPath:{defaultValue:null,description:"",name:"apiPath",required:!0,type:{name:"string"}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"object"}},onSuccess:{defaultValue:null,description:"",name:"onSuccess",required:!1,type:{name:"(arg: any) => void"}},onError:{defaultValue:null,description:"",name:"onError",required:!1,type:{name:"(arg: any) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["utils/config-constants.tsx#postConfigUpdateToAPI"]={docgenInfo:postConfigUpdateToAPI.__docgenInfo,name:"postConfigUpdateToAPI",path:"utils/config-constants.tsx#postConfigUpdateToAPI"})}catch(__react_docgen_typescript_loader_error){}const TextField=({className,disabled,fieldName,label,maxLength,onBlur,onChange,onPressEnter,onHandleSubmit,pattern,placeholder,required,status,tip,type,useTrim,value,hasComplexityRequirements})=>{const[hasPwdChanged,setHasPwdChanged]=(0,react.useState)(!1),[showPwdButton,setShowPwdButton]=(0,react.useState)(!1),[form]=es_form.A.useForm(),handleChange=e=>{if(onChange){const val="numeric"===type?e:e.target.value;setShowPwdButton(!0),hasComplexityRequirements&&REGEX_PASSWORD.test(val)?setHasPwdChanged(!0):setHasPwdChanged(!1),onChange({fieldName,value:useTrim?val.trim():val})}};(0,react.useEffect)((()=>{form.setFieldsValue({inputFieldPassword:value})}),[value]);const handleBlur=e=>{const val=e.target.value;onBlur&&onBlur({value:val})},handlePressEnter=()=>{onPressEnter&&onPressEnter()},passwordComplexityRules=[];let Field=input.A,fieldProps={};"textarea"===type?(Field=input.A.TextArea,fieldProps={autoSize:!0}):"password"===type?(PASSWORD_COMPLEXITY_RULES.forEach((element=>{passwordComplexityRules.push(element)})),Field=input.A.Password,fieldProps={visibilityToggle:!0}):"numeric"===type?(Field=input_number.A,fieldProps={type:"number",min:1,max:10**maxLength-1}):"url"===type&&(fieldProps={type:"url",pattern});const fieldId=`field-${fieldName}`,{type:statusType}=status||{},containerClass=classnames_default()({"formfield-container":!0,"textfield-container":!0,[`type-${type}`]:!0,required,[`status-${statusType}`]:status});return(0,jsx_runtime.jsxs)("div",{className:containerClass,children:[label?(0,jsx_runtime.jsx)("div",{className:"label-side",children:(0,jsx_runtime.jsx)("label",{htmlFor:fieldId,className:"formfield-label",children:label})}):null,hasComplexityRequirements?(0,jsx_runtime.jsx)("div",{className:"input-side",children:(0,jsx_runtime.jsx)("div",{className:"input-group",children:(0,jsx_runtime.jsxs)(es_form.A,{name:"basic",form,initialValues:{inputFieldPassword:value},style:{width:"100%"},children:[(0,jsx_runtime.jsx)(es_form.A.Item,{name:"inputFieldPassword",rules:passwordComplexityRules,children:(0,jsx_runtime.jsx)(input.A.Password,{id:fieldId,className:`field ${className} ${fieldId}`,onChange:handleChange,onBlur:handleBlur,placeholder,onPressEnter:handlePressEnter,disabled,value})}),showPwdButton&&(0,jsx_runtime.jsx)("div",{style:{display:"flex",flexDirection:"row-reverse"},children:(0,jsx_runtime.jsx)(es_button.A,{type:"primary",size:"small",className:"submit-button",onClick:onHandleSubmit,disabled:!hasPwdChanged,children:"Update"})}),(0,jsx_runtime.jsx)(FormStatusIndicator,{status}),(0,jsx_runtime.jsx)("p",{className:"field-tip",children:tip})]})})}):(0,jsx_runtime.jsxs)("div",{className:"input-side",children:[(0,jsx_runtime.jsx)("div",{className:"input-group",children:(0,jsx_runtime.jsx)(Field,{id:fieldId,className:`field ${className} ${fieldId}`,...fieldProps,..."numeric"!==type&&{allowClear:!0},placeholder,maxLength,onChange:handleChange,onBlur:handleBlur,onPressEnter:handlePressEnter,disabled,value})}),(0,jsx_runtime.jsx)(FormStatusIndicator,{status}),(0,jsx_runtime.jsx)("p",{className:"field-tip",children:tip})]})]})};TextField.defaultProps={className:"",disabled:!1,label:"",maxLength:255,placeholder:"",required:!1,status:null,tip:"",type:"default",value:"",pattern:"",useTrim:!1,useTrimLead:!1,hasComplexityRequirements:!1,onSubmit:()=>{},onBlur:()=>{},onChange:()=>{},onPressEnter:()=>{},onHandleSubmit:()=>{}};try{TextField.displayName="TextField",TextField.__docgenInfo={description:"",displayName:"TextField",props:{fieldName:{defaultValue:null,description:"",name:"fieldName",required:!0,type:{name:"string"}},onSubmit:{defaultValue:{value:"() => {}"},description:"",name:"onSubmit",required:!1,type:{name:"() => void"}},onPressEnter:{defaultValue:{value:"() => {}"},description:"",name:"onPressEnter",required:!1,type:{name:"() => void"}},onHandleSubmit:{defaultValue:{value:"() => {}"},description:"",name:"onHandleSubmit",required:!1,type:{name:"() => void"}},className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string"}},disabled:{defaultValue:{value:"false"},description:"",name:"disabled",required:!1,type:{name:"boolean"}},label:{defaultValue:{value:""},description:"",name:"label",required:!1,type:{name:"string"}},maxLength:{defaultValue:{value:"255"},description:"",name:"maxLength",required:!1,type:{name:"number"}},pattern:{defaultValue:{value:""},description:"",name:"pattern",required:!1,type:{name:"string"}},placeholder:{defaultValue:{value:""},description:"",name:"placeholder",required:!1,type:{name:"string"}},required:{defaultValue:{value:"false"},description:"",name:"required",required:!1,type:{name:"boolean"}},status:{defaultValue:{value:"null"},description:"",name:"status",required:!1,type:{name:"StatusState"}},tip:{defaultValue:{value:""},description:"",name:"tip",required:!1,type:{name:"string"}},type:{defaultValue:{value:"default"},description:"",name:"type",required:!1,type:{name:"string"}},useTrim:{defaultValue:{value:"false"},description:"",name:"useTrim",required:!1,type:{name:"boolean"}},useTrimLead:{defaultValue:{value:"false"},description:"",name:"useTrimLead",required:!1,type:{name:"boolean"}},value:{defaultValue:{value:""},description:"",name:"value",required:!1,type:{name:"string | number"}},hasComplexityRequirements:{defaultValue:{value:"false"},description:"",name:"hasComplexityRequirements",required:!1,type:{name:"boolean"}},onBlur:{defaultValue:{value:"() => {}"},description:"",name:"onBlur",required:!1,type:{name:"FieldUpdaterFunc"}},onChange:{defaultValue:{value:"() => {}"},description:"",name:"onChange",required:!1,type:{name:"FieldUpdaterFunc"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["components/admin/TextField.tsx#TextField"]={docgenInfo:TextField.__docgenInfo,name:"TextField",path:"components/admin/TextField.tsx#TextField"})}catch(__react_docgen_typescript_loader_error){}var dynamic=__webpack_require__("./node_modules/next/dynamic.js"),dynamic_default=__webpack_require__.n(dynamic);const CheckCircleFilled=dynamic_default()((()=>Promise.all([__webpack_require__.e(3827),__webpack_require__.e(6036)]).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@ant-design/icons/CheckCircleFilled.js",23))),{loadableGenerated:{webpack:()=>["./node_modules/@ant-design/icons/CheckCircleFilled.js"]},ssr:!1}),ExclamationCircleFilled=dynamic_default()((()=>Promise.all([__webpack_require__.e(3827),__webpack_require__.e(5453)]).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@ant-design/icons/ExclamationCircleFilled.js",23))),{loadableGenerated:{webpack:()=>["./node_modules/@ant-design/icons/ExclamationCircleFilled.js"]},ssr:!1}),LoadingOutlined=dynamic_default()((()=>Promise.all([__webpack_require__.e(3827),__webpack_require__.e(7142)]).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@ant-design/icons/LoadingOutlined.js",23))),{loadableGenerated:{webpack:()=>["./node_modules/@ant-design/icons/LoadingOutlined.js"]},ssr:!1}),WarningOutlined=dynamic_default()((()=>Promise.all([__webpack_require__.e(3827),__webpack_require__.e(8086)]).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@ant-design/icons/WarningOutlined.js",23))),{loadableGenerated:{webpack:()=>["./node_modules/@ant-design/icons/WarningOutlined.js"]},ssr:!1}),STATUS_ERROR="error",STATUS_PROCESSING="proessing",STATUS_SUCCESS="success",STATUS_WARNING="warning",STATUS_INVALID="invalid",INPUT_STATES={[STATUS_SUCCESS]:{type:"success",icon:(0,jsx_runtime.jsx)(CheckCircleFilled,{style:{color:"green"}}),message:"Success!"},[STATUS_ERROR]:{type:"error",icon:(0,jsx_runtime.jsx)(ExclamationCircleFilled,{style:{color:"red"}}),message:"An error occurred."},[STATUS_INVALID]:{type:"invalid",icon:(0,jsx_runtime.jsx)(ExclamationCircleFilled,{style:{color:"red"}}),message:"An error occurred."},[STATUS_PROCESSING]:{type:"proessing",icon:(0,jsx_runtime.jsx)(LoadingOutlined,{}),message:""},[STATUS_WARNING]:{type:"warning",icon:(0,jsx_runtime.jsx)(WarningOutlined,{style:{color:"#fc0"}}),message:""}};function createInputStatus(type,message){return type&&INPUT_STATES[type]?message?{type,icon:INPUT_STATES[type].icon,message}:INPUT_STATES[type]:null}var console=__webpack_require__("./node_modules/console-browserify/index.js");const initialServerConfigState={streamKeys:[],streamKeyOverridden:!1,adminPassword:"",instanceDetails:{customStyles:"",customJavascript:"",extraPageContent:"",logo:"",name:"",nsfw:!1,socialHandles:[],streamTitle:"",summary:"",tags:[],title:"",welcomeMessage:"",offlineMessage:"",appearanceVariables:{}},ffmpegPath:"",rtmpServerPort:"",webServerPort:"",socketHostOverride:null,videoServingEndpoint:"",s3:{accessKey:"",acl:"",bucket:"",enabled:!1,endpoint:"",region:"",secret:"",pathPrefix:"",forcePathStyle:!1},yp:{enabled:!1,instanceUrl:""},videoSettings:{latencyLevel:4,cpuUsageLevel:3,videoQualityVariants:[{framerate:24,videoPassthrough:!1,videoBitrate:1200,audioPassthrough:!0,audioBitrate:0,cpuUsageLevel:2,scaledHeight:null,scaledWidth:null,name:""}]},federation:{enabled:!1,isPrivate:!1,username:"",goLiveMessage:"",showEngagement:!0,blockedDomains:[]},notifications:{browser:{enabled:!1,goLiveMessage:""},discord:{enabled:!1,webhook:"",goLiveMessage:""}},externalActions:[],supportedCodecs:[],videoCodec:"",forbiddenUsernames:[],suggestedUsernames:[],chatDisabled:!1,chatSpamProtectionEnabled:!0,chatSlurFilterEnabled:!1,chatJoinMessagesEnabled:!0,chatEstablishedUserMode:!1,hideViewerCount:!1,disableSearchIndexing:!1},initialServerStatusState={broadcastActive:!1,broadcaster:null,currentBroadcast:null,online:!1,viewerCount:0,sessionMaxViewerCount:0,sessionPeakViewerCount:0,overallPeakViewerCount:0,versionNumber:"0.0.0",streamTitle:"",chatDisabled:!1,health:{healthy:!0,healthPercentage:100,message:"",representation:0},error:{type:null,msg:null}},ServerStatusContext=react.createContext({...initialServerStatusState,serverConfig:initialServerConfigState,setFieldInConfigState:_args=>null}),server_status_context=({children})=>{const[status,setStatus]=(0,react.useState)(initialServerStatusState),[config,setConfig]=(0,react.useState)(initialServerConfigState),getStatus=async()=>{try{const result=await(0,apis.Fd)(apis.XQ);if(result instanceof Error)throw result;setStatus({...result,error:{type:null,msg:null}})}catch(error){setStatus((initialStatus=>({...initialStatus,error:{type:"OWNCAST_SERVICE_UNREACHABLE",msg:"Cannot connect to the Owncast service. Please check you are connected to the internet and the Owncast server is running."}})))}};(0,react.useEffect)((()=>{let getStatusIntervalId=null;return getStatus(),getStatusIntervalId=setInterval(getStatus,apis.r1),(async()=>{try{const result=await(0,apis.Fd)(apis.Fq);if(result instanceof Error)throw result;setConfig(result)}catch(error){console.error(error)}})(),()=>{clearInterval(getStatusIntervalId)}}),[]);const providerValue={...status,serverConfig:config,setFieldInConfigState:({fieldName,value,path})=>{const updatedConfig=path?{...config,[path]:{...config[path],[fieldName]:value}}:{...config,[fieldName]:value};setConfig(updatedConfig)}};return(0,jsx_runtime.jsx)(ServerStatusContext.Provider,{value:providerValue,children})};try{serverstatuscontext.displayName="serverstatuscontext",serverstatuscontext.__docgenInfo={description:"",displayName:"serverstatuscontext",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["utils/server-status-context.tsx#serverstatuscontext"]={docgenInfo:serverstatuscontext.__docgenInfo,name:"serverstatuscontext",path:"utils/server-status-context.tsx#serverstatuscontext"})}catch(__react_docgen_typescript_loader_error){}const TextFieldWithSubmit=({apiPath,configPath="",initialValue,useTrim,useTrimLead,...textFieldProps})=>{const[submitStatus,setSubmitStatus]=(0,react.useState)(null),[hasChanged,setHasChanged]=(0,react.useState)(!1),serverStatusData=(0,react.useContext)(ServerStatusContext),{setFieldInConfigState}=serverStatusData||{};let resetTimer=null;const{fieldName,required,tip,status,value,hasComplexityRequirements,onChange,onSubmit}=textFieldProps,resetStates=()=>{setSubmitStatus(null),setHasChanged(!1),clearTimeout(resetTimer),resetTimer=null};(0,react.useEffect)((()=>{required&&(""===value||null===value)||value===initialValue?setHasChanged(!1):(resetStates(),setHasChanged(!0))}),[value]);const handleSubmit=async()=>{(required&&""!==value||value!==initialValue)&&(setSubmitStatus(createInputStatus("proessing")),await postConfigUpdateToAPI({apiPath,data:{value},onSuccess:()=>{setFieldInConfigState({fieldName,value,path:configPath}),setSubmitStatus(createInputStatus("success"))},onError:message=>{setSubmitStatus(createInputStatus("error",`There was an error: ${message}`))}}),resetTimer=setTimeout(resetStates,3e3),onSubmit&&onSubmit())},textfieldContainerClass=classnames_default()({"textfield-with-submit-container":!0,submittable:hasChanged});return(0,jsx_runtime.jsxs)("div",{className:textfieldContainerClass,children:[(0,jsx_runtime.jsx)("div",{className:"textfield-component",children:(0,jsx_runtime.jsx)(TextField,{...textFieldProps,onSubmit:null,onBlur:({value:changedValue})=>{onChange&&required&&""===changedValue&&onChange({fieldName,value:initialValue})},onChange:({fieldName:changedFieldName,value:changedValue})=>{if(onChange){let newValue=changedValue;useTrim?newValue=changedValue.trim():useTrimLead&&(newValue=changedValue.replace(/^\s+/g,"")),onChange({fieldName:changedFieldName,value:newValue})}},onHandleSubmit:handleSubmit})}),(0,jsx_runtime.jsxs)("div",{className:"formfield-container lower-container",children:[(0,jsx_runtime.jsx)("p",{className:"label-spacer"}),(0,jsx_runtime.jsxs)("div",{className:"lower-content",children:[(0,jsx_runtime.jsx)("div",{className:"field-tip",children:tip}),(0,jsx_runtime.jsx)(FormStatusIndicator,{status:status||submitStatus}),(0,jsx_runtime.jsx)("div",{className:"update-button-container",children:!hasComplexityRequirements&&(0,jsx_runtime.jsx)(es_button.A,{type:"primary",size:"small",className:"submit-button",onClick:handleSubmit,disabled:!hasChanged,children:"Update"})})]})]})]})};TextFieldWithSubmit.defaultProps={configPath:"",initialValue:""};try{TextFieldWithSubmit.displayName="TextFieldWithSubmit",TextFieldWithSubmit.__docgenInfo={description:"",displayName:"TextFieldWithSubmit",props:{fieldName:{defaultValue:null,description:"",name:"fieldName",required:!0,type:{name:"string"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!1,type:{name:"() => void"}},onPressEnter:{defaultValue:null,description:"",name:"onPressEnter",required:!1,type:{name:"() => void"}},onHandleSubmit:{defaultValue:null,description:"",name:"onHandleSubmit",required:!1,type:{name:"() => void"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},label:{defaultValue:null,description:"",name:"label",required:!1,type:{name:"string"}},maxLength:{defaultValue:null,description:"",name:"maxLength",required:!1,type:{name:"number"}},pattern:{defaultValue:null,description:"",name:"pattern",required:!1,type:{name:"string"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},required:{defaultValue:null,description:"",name:"required",required:!1,type:{name:"boolean"}},status:{defaultValue:null,description:"",name:"status",required:!1,type:{name:"StatusState"}},tip:{defaultValue:null,description:"",name:"tip",required:!1,type:{name:"string"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"string"}},useTrim:{defaultValue:null,description:"",name:"useTrim",required:!1,type:{name:"boolean"}},useTrimLead:{defaultValue:null,description:"",name:"useTrimLead",required:!1,type:{name:"boolean"}},value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string | number"}},hasComplexityRequirements:{defaultValue:null,description:"",name:"hasComplexityRequirements",required:!1,type:{name:"boolean"}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!1,type:{name:"FieldUpdaterFunc"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"FieldUpdaterFunc"}},apiPath:{defaultValue:null,description:"",name:"apiPath",required:!0,type:{name:"string"}},configPath:{defaultValue:{value:""},description:"",name:"configPath",required:!1,type:{name:"string"}},initialValue:{defaultValue:{value:""},description:"",name:"initialValue",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["components/admin/TextFieldWithSubmit.tsx#TextFieldWithSubmit"]={docgenInfo:TextFieldWithSubmit.__docgenInfo,name:"TextFieldWithSubmit",path:"components/admin/TextFieldWithSubmit.tsx#TextFieldWithSubmit"})}catch(__react_docgen_typescript_loader_error){}var es_switch=__webpack_require__("./node_modules/antd/es/switch/index.js");const ToggleSwitch=({apiPath,checked,reversed=!1,configPath="",disabled=!1,fieldName,label,tip,useSubmit,onChange})=>{const[submitStatus,setSubmitStatus]=(0,react.useState)(null);let resetTimer=null;const serverStatusData=(0,react.useContext)(ServerStatusContext),{setFieldInConfigState}=serverStatusData||{},resetStates=()=>{setSubmitStatus(null),clearTimeout(resetTimer),resetTimer=null},loading=null!==submitStatus&&"proessing"===submitStatus.type;return(0,jsx_runtime.jsxs)("div",{className:"formfield-container toggleswitch-container",children:[label&&(0,jsx_runtime.jsx)("div",{className:"label-side",children:(0,jsx_runtime.jsx)("span",{className:"formfield-label",children:label})}),(0,jsx_runtime.jsxs)("div",{className:"input-side",children:[(0,jsx_runtime.jsxs)("div",{className:"input-group",children:[(0,jsx_runtime.jsx)(es_switch.A,{className:`switch field-${fieldName}`,loading,onChange:async isChecked=>{if(useSubmit){setSubmitStatus(createInputStatus("proessing"));const isCheckedSend=reversed?!isChecked:isChecked;await postConfigUpdateToAPI({apiPath,data:{value:isCheckedSend},onSuccess:()=>{setFieldInConfigState({fieldName,value:isCheckedSend,path:configPath}),setSubmitStatus(createInputStatus("success"))},onError:message=>{setSubmitStatus(createInputStatus("error",`There was an error: ${message}`))}}),resetTimer=setTimeout(resetStates,3e3)}onChange&&onChange(isChecked)},defaultChecked:checked,checked,checkedChildren:"ON",unCheckedChildren:"OFF",disabled}),(0,jsx_runtime.jsx)(FormStatusIndicator,{status:submitStatus})]}),(0,jsx_runtime.jsx)("p",{className:"field-tip",children:tip})]})]})};ToggleSwitch.defaultProps={apiPath:"",checked:!1,reversed:!1,configPath:"",disabled:!1,label:"",tip:"",useSubmit:!1,onChange:null};try{ToggleSwitch.displayName="ToggleSwitch",ToggleSwitch.__docgenInfo={description:"",displayName:"ToggleSwitch",props:{fieldName:{defaultValue:null,description:"",name:"fieldName",required:!0,type:{name:"string"}},apiPath:{defaultValue:{value:""},description:"",name:"apiPath",required:!1,type:{name:"string"}},checked:{defaultValue:{value:"false"},description:"",name:"checked",required:!1,type:{name:"boolean"}},reversed:{defaultValue:{value:"false"},description:"",name:"reversed",required:!1,type:{name:"boolean"}},configPath:{defaultValue:{value:""},description:"",name:"configPath",required:!1,type:{name:"string"}},disabled:{defaultValue:{value:"false"},description:"",name:"disabled",required:!1,type:{name:"boolean"}},label:{defaultValue:{value:""},description:"",name:"label",required:!1,type:{name:"string"}},tip:{defaultValue:{value:""},description:"",name:"tip",required:!1,type:{name:"string"}},useSubmit:{defaultValue:{value:"false"},description:"",name:"useSubmit",required:!1,type:{name:"boolean"}},onChange:{defaultValue:{value:"null"},description:"",name:"onChange",required:!1,type:{name:"(arg: boolean) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["components/admin/ToggleSwitch.tsx#ToggleSwitch"]={docgenInfo:ToggleSwitch.__docgenInfo,name:"ToggleSwitch",path:"components/admin/ToggleSwitch.tsx#ToggleSwitch"})}catch(__react_docgen_typescript_loader_error){}var es_tag=__webpack_require__("./node_modules/antd/es/tag/index.js");const{Title}=typography.A,EditValueArray=({title,description,placeholder,maxLength,values,handleDeleteIndex,handleCreateString,submitStatus,continuousStatusMessage})=>{const[newStringInput,setNewStringInput]=(0,react.useState)("");return(0,jsx_runtime.jsxs)("div",{className:"edit-string-array-container",children:[(0,jsx_runtime.jsx)(Title,{level:3,className:"section-title",children:title}),(0,jsx_runtime.jsx)("p",{className:"description",children:description}),(0,jsx_runtime.jsx)("div",{className:"edit-current-strings",children:null==values?void 0:values.map(((tag,index)=>(0,jsx_runtime.jsx)(es_tag.A,{closable:!0,onClose:()=>{handleDeleteIndex(index)},color:"#5a67d8",children:tag},`tag-${tag}-${index}`)))}),continuousStatusMessage&&(0,jsx_runtime.jsx)("div",{className:"continuous-status-section",children:(0,jsx_runtime.jsx)(FormStatusIndicator,{status:continuousStatusMessage})}),(0,jsx_runtime.jsx)("div",{className:"add-new-string-section",children:(0,jsx_runtime.jsx)(TextField,{fieldName:"string-input",value:newStringInput,onChange:({value})=>{setNewStringInput(value)},onPressEnter:()=>{const newString=newStringInput.trim();handleCreateString(newString),setNewStringInput("")},maxLength,placeholder,status:submitStatus})})]})};EditValueArray.defaultProps={maxLength:50,description:null,submitStatus:null,continuousStatusMessage:null};try{EditValueArray.displayName="EditValueArray",EditValueArray.__docgenInfo={description:"",displayName:"EditValueArray",props:{title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},description:{defaultValue:{value:"null"},description:"",name:"description",required:!1,type:{name:"string"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!0,type:{name:"string"}},maxLength:{defaultValue:{value:"50"},description:"",name:"maxLength",required:!1,type:{name:"number"}},values:{defaultValue:null,description:"",name:"values",required:!0,type:{name:"string[]"}},submitStatus:{defaultValue:{value:"null"},description:"",name:"submitStatus",required:!1,type:{name:"StatusState"}},continuousStatusMessage:{defaultValue:{value:"null"},description:"",name:"continuousStatusMessage",required:!1,type:{name:"StatusState"}},handleDeleteIndex:{defaultValue:null,description:"",name:"handleDeleteIndex",required:!0,type:{name:"(index: number) => void"}},handleCreateString:{defaultValue:null,description:"",name:"handleCreateString",required:!0,type:{name:"(arg: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["components/admin/EditValueArray.tsx#EditValueArray"]={docgenInfo:EditValueArray.__docgenInfo,name:"EditValueArray",path:"components/admin/EditValueArray.tsx#EditValueArray"})}catch(__react_docgen_typescript_loader_error){}const AlertMessageContext=react.createContext({message:null,setMessage:_text=>null}),alert_message_context=({children})=>{const[message,setMessage]=(0,react.useState)(""),providerValue={message,setMessage};return(0,jsx_runtime.jsx)(AlertMessageContext.Provider,{value:providerValue,children})};try{alertmessagecontext.displayName="alertmessagecontext",alertmessagecontext.__docgenInfo={description:"",displayName:"alertmessagecontext",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["utils/alert-message-context.tsx#alertmessagecontext"]={docgenInfo:alertmessagecontext.__docgenInfo,name:"alertmessagecontext",path:"utils/alert-message-context.tsx#alertmessagecontext"})}catch(__react_docgen_typescript_loader_error){}var next_link=__webpack_require__("./node_modules/next/link.js"),link_default=__webpack_require__.n(next_link),head=__webpack_require__("./node_modules/next/head.js"),head_default=__webpack_require__.n(head),differenceInSeconds=__webpack_require__("./node_modules/date-fns/differenceInSeconds.js"),export_mocks_router=__webpack_require__("./node_modules/@storybook/nextjs/dist/export-mocks/router/index.mjs"),layout=__webpack_require__("./node_modules/antd/es/layout/index.js"),menu=__webpack_require__("./node_modules/antd/es/menu/index.js"),space=__webpack_require__("./node_modules/antd/es/space/index.js"),tooltip=__webpack_require__("./node_modules/antd/es/tooltip/index.js"),format=__webpack_require__("./utils/format.ts"),OwncastLogo=__webpack_require__("./components/common/OwncastLogo/OwncastLogo.tsx"),ComposeFederatedPost_console=__webpack_require__("./node_modules/console-browserify/index.js");const{TextArea}=input.A,ComposeFederatedPost=({open,handleClose})=>{const[content,setContent]=(0,react.useState)(""),[postPending,setPostPending]=(0,react.useState)(!1),[postSuccessState,setPostSuccessState]=(0,react.useState)(null);function close(){setPostPending(!1),setPostSuccessState(null),handleClose()}return(0,jsx_runtime.jsxs)(modal.A,{destroyOnClose:!0,width:600,title:"Post to Followers",open,onCancel:handleClose,footer:[(0,jsx_runtime.jsx)(es_button.A,{onClick:()=>handleClose(),children:"Cancel"}),(0,jsx_runtime.jsx)(es_button.A,{type:"primary",onClick:async function sendButtonClicked(){setPostPending(!0);const data={value:content};try{await(0,apis.Fd)(apis.D0,{data,method:"POST",auth:!0}),setPostSuccessState("success"),setTimeout(close,1e3)}catch(e){ComposeFederatedPost_console.error(e),setPostSuccessState("error")}setPostPending(!1)},disabled:postPending||postSuccessState,loading:postPending,children:(null==postSuccessState?void 0:postSuccessState.toUpperCase())||"Post"})],children:[(0,jsx_runtime.jsx)("h3",{children:"Tell the world about your future streaming plans or let your followers know to tune in."}),(0,jsx_runtime.jsx)(TextArea,{placeholder:"I'm still live, come join me!",size:"large",showCount:!0,maxLength:500,style:{height:"150px",width:"100%"},onChange:function handleEditorChange(e){setContent(e.target.value)}})]})};try{ComposeFederatedPost.displayName="ComposeFederatedPost",ComposeFederatedPost.__docgenInfo={description:"",displayName:"ComposeFederatedPost",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},handleClose:{defaultValue:null,description:"",name:"handleClose",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["components/admin/ComposeFederatedPost.tsx#ComposeFederatedPost"]={docgenInfo:ComposeFederatedPost.__docgenInfo,name:"ComposeFederatedPost",path:"components/admin/ComposeFederatedPost.tsx#ComposeFederatedPost"})}catch(__react_docgen_typescript_loader_error){}var FatalErrorStateModal=__webpack_require__("./components/modals/FatalErrorStateModal/FatalErrorStateModal.tsx"),MainLayout_console=__webpack_require__("./node_modules/console-browserify/index.js");const SettingOutlined=dynamic_default()((()=>Promise.all([__webpack_require__.e(3827),__webpack_require__.e(3002)]).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@ant-design/icons/SettingOutlined.js",23))),{loadableGenerated:{webpack:()=>["./node_modules/@ant-design/icons/SettingOutlined.js"]},ssr:!1}),HomeOutlined=dynamic_default()((()=>Promise.all([__webpack_require__.e(3827),__webpack_require__.e(4523)]).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@ant-design/icons/HomeOutlined.js",23))),{loadableGenerated:{webpack:()=>["./node_modules/@ant-design/icons/HomeOutlined.js"]},ssr:!1}),LineChartOutlined=dynamic_default()((()=>Promise.all([__webpack_require__.e(3827),__webpack_require__.e(8644)]).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@ant-design/icons/LineChartOutlined.js",23))),{loadableGenerated:{webpack:()=>["./node_modules/@ant-design/icons/LineChartOutlined.js"]},ssr:!1}),ToolOutlined=dynamic_default()((()=>Promise.all([__webpack_require__.e(3827),__webpack_require__.e(4614)]).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@ant-design/icons/ToolOutlined.js",23))),{loadableGenerated:{webpack:()=>["./node_modules/@ant-design/icons/ToolOutlined.js"]},ssr:!1}),PlayCircleFilled=dynamic_default()((()=>Promise.all([__webpack_require__.e(3827),__webpack_require__.e(7016)]).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@ant-design/icons/PlayCircleFilled.js",23))),{loadableGenerated:{webpack:()=>["./node_modules/@ant-design/icons/PlayCircleFilled.js"]},ssr:!1}),MinusSquareFilled=dynamic_default()((()=>Promise.all([__webpack_require__.e(3827),__webpack_require__.e(511)]).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@ant-design/icons/MinusSquareFilled.js",23))),{loadableGenerated:{webpack:()=>["./node_modules/@ant-design/icons/MinusSquareFilled.js"]},ssr:!1}),QuestionCircleOutlined=dynamic_default()((()=>Promise.all([__webpack_require__.e(3827),__webpack_require__.e(1516)]).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@ant-design/icons/QuestionCircleOutlined.js",23))),{loadableGenerated:{webpack:()=>["./node_modules/@ant-design/icons/QuestionCircleOutlined.js"]},ssr:!1}),MessageOutlined=dynamic_default()((()=>Promise.all([__webpack_require__.e(3827),__webpack_require__.e(7437)]).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@ant-design/icons/MessageOutlined.js",23))),{loadableGenerated:{webpack:()=>["./node_modules/@ant-design/icons/MessageOutlined.js"]},ssr:!1}),ExperimentOutlined=dynamic_default()((()=>Promise.all([__webpack_require__.e(3827),__webpack_require__.e(4311)]).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@ant-design/icons/ExperimentOutlined.js",23))),{loadableGenerated:{webpack:()=>["./node_modules/@ant-design/icons/ExperimentOutlined.js"]},ssr:!1}),EditOutlined=dynamic_default()((()=>Promise.all([__webpack_require__.e(3827),__webpack_require__.e(740)]).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@ant-design/icons/EditOutlined.js",23))),{loadableGenerated:{webpack:()=>["./node_modules/@ant-design/icons/EditOutlined.js"]},ssr:!1}),FediverseOutlined=dynamic_default()((()=>__webpack_require__.e(4291).then(__webpack_require__.bind(__webpack_require__,"./assets/images/icons/fediverse.svg"))),{loadableGenerated:{webpack:()=>["./assets/images/icons/fediverse.svg"]},ssr:!1}),MainLayout=({children})=>{const context=(0,react.useContext)(ServerStatusContext),{serverConfig,online,broadcaster,versionNumber,error:serverError}=context||{},{instanceDetails,chatDisabled,federation}=serverConfig,{enabled:federationEnabled}=federation,[currentStreamTitle,setCurrentStreamTitle]=(0,react.useState)(""),[postModalDisplayed,setPostModalDisplayed]=(0,react.useState)(!1),alertMessage=(0,react.useContext)(AlertMessageContext),router=(0,export_mocks_router.useRouter)(),{route}=router||{},{Header,Footer,Content,Sider}=layout.A,[upgradeVersion,setUpgradeVersion]=(0,react.useState)("");(0,react.useEffect)((()=>{(async()=>{try{const result=await(0,apis.e0)(versionNumber);setUpgradeVersion(result)}catch(error){MainLayout_console.log("==== error",error)}})()}),[versionNumber]),(0,react.useEffect)((()=>{setCurrentStreamTitle(instanceDetails.streamTitle)}),[instanceDetails]);const appClass=classnames_default()({"app-container":!0,online}),upgradeMessage=`Upgrade to v${`${upgradeVersion}`||""}`,openMenuItems=upgradeVersion?["utilities-menu"]:[],headerAlertMessage=alertMessage.message?(0,jsx_runtime.jsx)(es_alert.A,{message:alertMessage.message,afterClose:()=>{alertMessage.setMessage(null)},banner:!0,closable:!0}):null,streamDurationString=broadcaster?(0,format.RW)((0,differenceInSeconds.O)(new Date,new Date(broadcaster.time))):"",statusIcon=online?(0,jsx_runtime.jsx)(PlayCircleFilled,{}):(0,jsx_runtime.jsx)(MinusSquareFilled,{}),statusMessage=online?`Online ${streamDurationString}`:"Offline",statusIndicator=(0,jsx_runtime.jsxs)("div",{className:"online-status-indicator",children:[(0,jsx_runtime.jsx)("span",{className:"status-label",children:statusMessage}),(0,jsx_runtime.jsx)("span",{className:"status-icon",children:statusIcon})]}),integrationsMenu=[{label:(0,jsx_runtime.jsx)(link_default(),{href:"/admin/webhooks",children:"Webhooks"}),key:"/admin/webhooks"},{label:(0,jsx_runtime.jsx)(link_default(),{href:"/admin/access-tokens",children:"Access Tokens"}),key:"/admin/access-tokens"},{label:(0,jsx_runtime.jsx)(link_default(),{href:"/admin/actions",children:"External Actions"}),key:"/admin/actions"}],chatMenu=[{label:(0,jsx_runtime.jsx)(link_default(),{href:"/admin/chat/messages",children:"Messages"}),key:"/admin/chat/messages"},{label:(0,jsx_runtime.jsx)(link_default(),{href:"/admin/chat/users",children:"Users"}),key:"/admin/chat/users"},{label:(0,jsx_runtime.jsx)(link_default(),{href:"/admin/chat/emojis",children:"Emojis"}),key:"/admin/chat/emojis"}],utilitiesMenu=[{label:(0,jsx_runtime.jsx)(link_default(),{href:"/admin/hardware-info",children:"Hardware"}),key:"/admin/hardware-info"},{label:(0,jsx_runtime.jsx)(link_default(),{href:"/admin/stream-health",children:"Stream Health"}),key:"/admin/stream-health"},{label:(0,jsx_runtime.jsx)(link_default(),{href:"/admin/logs",children:"Logs"}),key:"/admin/logs"},federationEnabled&&{label:(0,jsx_runtime.jsx)(link_default(),{href:"/admin/federation/actions",children:"Social Actions"}),key:"/admin/federation/actions"}],configurationMenu=[{label:(0,jsx_runtime.jsx)(link_default(),{href:"/admin/config/general",children:"General"}),key:"/admin/config/general"},{label:(0,jsx_runtime.jsx)(link_default(),{href:"/admin/config/server",children:"Server Setup"}),key:"/admin/config/server"},{label:(0,jsx_runtime.jsx)(link_default(),{href:"/admin/config-video",children:"Video"}),key:"/admin/config-video"},{label:(0,jsx_runtime.jsx)(link_default(),{href:"/admin/config-chat",children:"Chat"}),key:"/admin/config-chat"},{label:(0,jsx_runtime.jsx)(link_default(),{href:"/admin/config-federation",children:"Social"}),key:"/admin/config-federation"},{label:(0,jsx_runtime.jsx)(link_default(),{href:"/admin/config-notify",children:"Notifications"}),key:"/admin/config-notify"}],menuItems=[{label:(0,jsx_runtime.jsx)(link_default(),{href:"/admin",children:"Home"}),icon:(0,jsx_runtime.jsx)(HomeOutlined,{}),key:"/admin"},{label:(0,jsx_runtime.jsx)(link_default(),{href:"/admin/viewer-info",children:"Viewers"}),icon:(0,jsx_runtime.jsx)(LineChartOutlined,{}),key:"/admin/viewer-info"},!chatDisabled&&{label:(0,jsx_runtime.jsx)("span",{children:"Chat & Users"}),icon:(0,jsx_runtime.jsx)(MessageOutlined,{}),children:chatMenu,key:"chat-and-users"},federationEnabled&&{key:"/admin/federation/followers",label:(0,jsx_runtime.jsx)(link_default(),{href:"/admin/federation/followers",children:"Followers"}),icon:(0,jsx_runtime.jsx)("span",{role:"img","aria-label":"message",className:"anticon anticon-message ant-menu-item-icon",children:(0,jsx_runtime.jsx)(FediverseOutlined,{})})},{key:"configuration",label:"Configuration",icon:(0,jsx_runtime.jsx)(SettingOutlined,{}),children:configurationMenu},{key:"utilities",label:"Utilities",icon:(0,jsx_runtime.jsx)(ToolOutlined,{}),children:utilitiesMenu},{key:"integrations",label:"Integrations",icon:(0,jsx_runtime.jsx)(ExperimentOutlined,{}),children:integrationsMenu},upgradeVersion&&{key:"/admin/upgrade",label:(0,jsx_runtime.jsx)(link_default(),{href:"/admin/upgrade",children:upgradeMessage})},{key:"/admin/help",label:(0,jsx_runtime.jsx)(link_default(),{href:"/admin/help",children:"Help"}),icon:(0,jsx_runtime.jsx)(QuestionCircleOutlined,{})}],[openKeys,setOpenKeys]=(0,react.useState)(openMenuItems);return(0,react.useEffect)((()=>{menuItems.forEach((item=>{var _item_children;return null==item||null===(_item_children=item.children)||void 0===_item_children?void 0:_item_children.forEach((child=>{(null==child?void 0:child.key)===route&&setOpenKeys([...openMenuItems,item.key])}))}))}),[]),(0,jsx_runtime.jsxs)(layout.A,{id:"admin-page",className:appClass,children:[(0,jsx_runtime.jsxs)(head_default(),{children:[(0,jsx_runtime.jsx)("title",{children:"Owncast Admin"}),(0,jsx_runtime.jsx)("link",{rel:"icon",type:"image/png",sizes:"32x32",href:"/img/favicon/favicon-32x32.png"})]}),"OWNCAST_SERVICE_UNREACHABLE"===(null==serverError?void 0:serverError.type)&&(0,jsx_runtime.jsx)(FatalErrorStateModal.FatalErrorStateModal,{title:"Server Unreachable",message:serverError.msg}),(0,jsx_runtime.jsxs)(Sider,{width:240,className:"side-nav",children:[(0,jsx_runtime.jsxs)("h1",{className:"owncast-title",children:[(0,jsx_runtime.jsx)("span",{className:"logo-container",children:(0,jsx_runtime.jsx)(OwncastLogo.N,{variant:"simple"})}),(0,jsx_runtime.jsx)("span",{className:"title-label",children:"Owncast Admin"})]}),(0,jsx_runtime.jsx)(menu.A,{mode:"inline",className:"menu-container",items:menuItems,selectedKeys:[route||"/admin"],openKeys,onOpenChange:keys=>{setOpenKeys(keys)}})]}),(0,jsx_runtime.jsxs)(layout.A,{className:"layout-main",children:[(0,jsx_runtime.jsxs)(Header,{className:"layout-header",children:[(0,jsx_runtime.jsx)(space.A,{direction:"horizontal",children:(0,jsx_runtime.jsx)(tooltip.A,{title:"Compose post to your social followers",children:(0,jsx_runtime.jsx)(es_button.A,{type:"link",icon:(0,jsx_runtime.jsx)(EditOutlined,{}),size:"small",onClick:()=>{setPostModalDisplayed(!0)},style:{display:federationEnabled?"block":"none",margin:"10px"},children:"Compose Post"})})}),(0,jsx_runtime.jsx)("div",{className:"global-stream-title-container",children:(0,jsx_runtime.jsx)(TextFieldWithSubmit,{fieldName:"streamTitle",...TEXTFIELD_PROPS_STREAM_TITLE,placeholder:"What are you streaming now? (Stream title)",value:currentStreamTitle,initialValue:instanceDetails.streamTitle,onChange:({value})=>{setCurrentStreamTitle(value)}})}),(0,jsx_runtime.jsx)(space.A,{direction:"horizontal",children:statusIndicator})]}),headerAlertMessage,(0,jsx_runtime.jsx)(Content,{className:"main-content-container",children}),(0,jsx_runtime.jsx)(Footer,{className:"footer-container",children:(0,jsx_runtime.jsxs)("a",{href:"https://owncast.online/?source=admin",target:"_blank",rel:"noopener noreferrer",children:["About Owncast v",versionNumber]})})]}),(0,jsx_runtime.jsx)(ComposeFederatedPost,{open:postModalDisplayed,handleClose:()=>setPostModalDisplayed(!1)})]})};try{MainLayout.displayName="MainLayout",MainLayout.__docgenInfo={description:"",displayName:"MainLayout",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["components/admin/MainLayout.tsx#MainLayout"]={docgenInfo:MainLayout.__docgenInfo,name:"MainLayout",path:"components/admin/MainLayout.tsx#MainLayout"})}catch(__react_docgen_typescript_loader_error){}const AdminLayout=({page})=>(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("link",{rel:"stylesheet",href:"/styles/admin/main-layout.css"}),(0,jsx_runtime.jsx)("link",{rel:"stylesheet",href:"/styles/admin/form-textfields.css"}),(0,jsx_runtime.jsx)("link",{rel:"stylesheet",href:"/styles/admin/config-socialhandles.css"}),(0,jsx_runtime.jsx)("link",{rel:"stylesheet",href:"/styles/admin/config-storage.css"}),(0,jsx_runtime.jsx)("link",{rel:"stylesheet",href:"/styles/admin/config-edit-string-tags.css"}),(0,jsx_runtime.jsx)("link",{rel:"stylesheet",href:"/styles/admin/config-video-variants.css"}),(0,jsx_runtime.jsx)("link",{rel:"stylesheet",href:"/styles/admin/config-public-details.css"}),(0,jsx_runtime.jsx)("link",{rel:"stylesheet",href:"/styles/admin/home.css"}),(0,jsx_runtime.jsx)("link",{rel:"stylesheet",href:"/styles/admin/chat.css"}),(0,jsx_runtime.jsx)(server_status_context,{children:(0,jsx_runtime.jsx)(alert_message_context,{children:(0,jsx_runtime.jsx)(MainLayout,{children:page})})})]});try{AdminLayout.displayName="AdminLayout",AdminLayout.__docgenInfo={description:"",displayName:"AdminLayout",props:{page:{defaultValue:null,description:"",name:"page",required:!0,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["components/layouts/AdminLayout.tsx#AdminLayout"]={docgenInfo:AdminLayout.__docgenInfo,name:"AdminLayout",path:"components/layouts/AdminLayout.tsx#AdminLayout"})}catch(__react_docgen_typescript_loader_error){}var config_federation_console=__webpack_require__("./node_modules/console-browserify/index.js");const FederationInfoModal=({cancelPressed,okPressed})=>(0,jsx_runtime.jsxs)(modal.A,{width:"70%",title:"Enable Social Features",visible:!0,onCancel:cancelPressed,footer:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(es_button.A,{onClick:cancelPressed,children:"Do not enable"}),(0,jsx_runtime.jsx)(es_button.A,{type:"primary",onClick:okPressed,children:"Enable Social Features"})]}),children:[(0,jsx_runtime.jsx)(typography.A.Title,{level:3,children:"How do Owncast's social features work?"}),(0,jsx_runtime.jsxs)(typography.A.Paragraph,{children:["Owncast's social features are accomplished by having your server join The"," ",(0,jsx_runtime.jsx)("a",{href:"https://en.wikipedia.org/wiki/Fediverse",rel:"noopener noreferrer",target:"_blank",children:"Fediverse"}),", a decentralized, open, collection of independent servers, like yours."]}),"Please"," ",(0,jsx_runtime.jsx)("a",{href:"https://owncast.online/docs/social",rel:"noopener noreferrer",target:"_blank",children:"read more"})," ","about these features, the details behind them, and how they work.",(0,jsx_runtime.jsx)(typography.A.Paragraph,{}),(0,jsx_runtime.jsx)(typography.A.Title,{level:3,children:"What do you need to know?"}),(0,jsx_runtime.jsxs)("ul",{children:[(0,jsx_runtime.jsx)("li",{children:"These features are brand new. Given the variability of interfacing with the rest of the world, bugs are possible. Please report anything that you think isn't working quite right."}),(0,jsx_runtime.jsx)("li",{children:"You must always host your Owncast server with SSL using a https url."}),(0,jsx_runtime.jsx)("li",{children:"You should not change your server name URL or social username once people begin following you, as your server will be seen as a completely different user on the Fediverse, and the old user will disappear."}),(0,jsx_runtime.jsxs)("li",{children:["Turning on ",(0,jsx_runtime.jsx)("i",{children:"Private mode"})," will allow you to manually approve each follower and limit the visibility of your posts to followers only."]})]}),(0,jsx_runtime.jsx)(typography.A.Title,{level:3,children:"Learn more about The Fediverse"}),(0,jsx_runtime.jsxs)(typography.A.Paragraph,{children:["If these concepts are new you should discover more about what this functionality has to offer. Visit"," ",(0,jsx_runtime.jsx)("a",{href:"https://owncast.online/docs/social",rel:"noopener noreferrer",target:"_blank",children:"our documentation"})," ","to be pointed at some resources that will help get you started on The Fediverse."]})]}),ConfigFederation=()=>{const{Title}=typography.A,[formDataValues,setFormDataValues]=(0,react.useState)(null),[isInfoModalOpen,setIsInfoModalOpen]=(0,react.useState)(!1),serverStatusData=(0,react.useContext)(ServerStatusContext),{serverConfig,setFieldInConfigState}=serverStatusData||{},[blockedDomainSaveState,setBlockedDomainSaveState]=(0,react.useState)(null),{federation,yp,instanceDetails}=serverConfig,{enabled,isPrivate,username,goLiveMessage,showEngagement,blockedDomains}=federation,{instanceUrl}=yp,{nsfw}=instanceDetails,handleFieldChange=({fieldName,value})=>{setFormDataValues({...formDataValues,[fieldName]:value})};function resetBlockedDomainsSaveState(){setBlockedDomainSaveState(null)}function saveBlockedDomains(){try{postConfigUpdateToAPI({apiPath:"/federation/blockdomains",data:{value:formDataValues.blockedDomains},onSuccess:()=>{setFieldInConfigState({fieldName:"forbiddenUsernames",value:formDataValues.forbiddenUsernames}),setBlockedDomainSaveState("success"),setTimeout(resetBlockedDomainsSaveState,3e3)},onError:message=>{setBlockedDomainSaveState(createInputStatus("error",message)),setTimeout(resetBlockedDomainsSaveState,3e3)}})}catch(e){config_federation_console.error(e),setBlockedDomainSaveState("error")}}if((0,react.useEffect)((()=>{setFormDataValues({enabled,isPrivate,username,goLiveMessage,showEngagement,blockedDomains,nsfw,instanceUrl:yp.instanceUrl})}),[serverConfig,yp]),!formDataValues)return null;const hasInstanceUrl=""!==instanceUrl,isInstanceUrlSecure=instanceUrl.startsWith("https://"),configurationWarning=!isInstanceUrlSecure&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(es_alert.A,{message:"You must set your server URL before you can enable this feature.",type:"warning",showIcon:!0}),(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)(TextFieldWithSubmit,{fieldName:"instanceUrl",...TEXTFIELD_PROPS_FEDERATION_INSTANCE_URL,value:formDataValues.instanceUrl,initialValue:yp.instanceUrl,type:"url",onChange:handleFieldChange,onSubmit:()=>{const hasInstanceUrl=""!==formDataValues.instanceUrl,isInstanceUrlSecure=formDataValues.instanceUrl.startsWith("https://");hasInstanceUrl&&isInstanceUrlSecure||(postConfigUpdateToAPI({apiPath:FIELD_PROPS_ENABLE_FEDERATION.apiPath,data:{value:!1}}),setFormDataValues({...formDataValues,enabled:!1}))},required:!0})]}),invalidPortWarning=(0,jsx_runtime.jsx)(es_alert.A,{message:"Only Owncast instances available on the default SSL port 443 support this feature.",type:"warning",showIcon:!0}),hasInvalidPort=instanceUrl&&""!==new URL(instanceUrl).port&&"443"!==new URL(instanceUrl).port;return(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(Title,{children:"Configure Social Features"}),(0,jsx_runtime.jsx)("p",{children:"Owncast provides the ability for people to follow and engage with your instance. It's a great way to promote alerting, sharing and engagement of your stream."}),(0,jsx_runtime.jsx)("p",{children:"Once enabled you'll alert your followers when you go live as well as gain the ability to compose custom posts to share any information you like."}),(0,jsx_runtime.jsx)("p",{children:(0,jsx_runtime.jsx)("a",{href:"https://owncast.online/docs/social",rel:"noopener noreferrer",target:"_blank",children:"Read more about the specifics of these social features."})}),(0,jsx_runtime.jsxs)(row.A,{children:[(0,jsx_runtime.jsxs)(col.A,{span:15,className:"form-module",style:{marginRight:"15px"},children:[configurationWarning,hasInvalidPort&&invalidPortWarning,(0,jsx_runtime.jsx)(ToggleSwitch,{fieldName:"enabled",onChange:value=>{value?setIsInfoModalOpen(!0):setFormDataValues({...formDataValues,enabled:!1})},...FIELD_PROPS_ENABLE_FEDERATION,checked:formDataValues.enabled,disabled:hasInvalidPort||!hasInstanceUrl||!isInstanceUrlSecure}),(0,jsx_runtime.jsx)(ToggleSwitch,{fieldName:"isPrivate",...FIELD_PROPS_FEDERATION_IS_PRIVATE,checked:formDataValues.isPrivate,disabled:!enabled}),(0,jsx_runtime.jsx)(ToggleSwitch,{fieldName:"nsfw",useSubmit:!0,...FIELD_PROPS_FEDERATION_NSFW,checked:formDataValues.nsfw,disabled:hasInvalidPort||!hasInstanceUrl}),(0,jsx_runtime.jsx)(TextFieldWithSubmit,{required:!0,fieldName:"username",type:"default",...TEXTFIELD_PROPS_FEDERATION_DEFAULT_USER,value:formDataValues.username,initialValue:username,onChange:({fieldName,value})=>{handleFieldChange({fieldName,value}),setFormDataValues({...formDataValues,username:value.replace(/\W/g,"")})},disabled:!enabled}),(0,jsx_runtime.jsx)(TextFieldWithSubmit,{fieldName:"goLiveMessage",...TEXTFIELD_PROPS_FEDERATION_LIVE_MESSAGE,type:"textarea",value:formDataValues.goLiveMessage,initialValue:goLiveMessage,onChange:handleFieldChange,disabled:!enabled}),(0,jsx_runtime.jsx)(ToggleSwitch,{fieldName:"showEngagement",...FIELD_PROPS_SHOW_FEDERATION_ENGAGEMENT,checked:formDataValues.showEngagement,disabled:!enabled})]}),(0,jsx_runtime.jsx)(col.A,{span:8,className:"form-module",children:(0,jsx_runtime.jsx)(EditValueArray,{title:FIELD_PROPS_FEDERATION_BLOCKED_DOMAINS_label,placeholder:FIELD_PROPS_FEDERATION_BLOCKED_DOMAINS_placeholder,description:FIELD_PROPS_FEDERATION_BLOCKED_DOMAINS_tip,values:formDataValues.blockedDomains,handleDeleteIndex:function handleDeleteBlockedDomain(index){formDataValues.blockedDomains.splice(index,1),saveBlockedDomains()},handleCreateString:function handleCreateBlockedDomain(domain){let newDomain;try{newDomain=new URL(domain).host}catch(e){newDomain=domain}formDataValues.blockedDomains.push(newDomain),handleFieldChange({fieldName:"blockedDomains",value:formDataValues.blockedDomains}),saveBlockedDomains()},submitStatus:createInputStatus(blockedDomainSaveState)})})]}),isInfoModalOpen&&(0,jsx_runtime.jsx)(FederationInfoModal,{cancelPressed:function federationInfoModalCancelPressed(){setIsInfoModalOpen(!1),setFormDataValues({...formDataValues,enabled:!1})},okPressed:function federationInfoModalOkPressed(){setIsInfoModalOpen(!1),setFormDataValues({...formDataValues,enabled:!0})}})]})};ConfigFederation.getLayout=function getLayout(page){return(0,jsx_runtime.jsx)(AdminLayout,{page})};const config_federation=ConfigFederation,config_federation_stories={title:"owncast/Admin/Config/Federation",component:config_federation,parameters:{}},Default=(arguments_=>(0,jsx_runtime.jsx)(config_federation,{...arguments_})).bind({});Default.args={};const __namedExportsOrder=["Default"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"arguments_ => <ConfigFederation {...arguments_} />",...Default.parameters?.docs?.source}}}},"./components/modals/FatalErrorStateModal/FatalErrorStateModal.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{FatalErrorStateModal:()=>FatalErrorStateModal});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),_barrel_optimize_names_Modal_antd__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/antd/es/modal/index.js");const FatalErrorStateModal=({title,message})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_barrel_optimize_names_Modal_antd__WEBPACK_IMPORTED_MODULE_1__.A,{title,visible:!0,footer:null,closable:!1,keyboard:!1,width:900,centered:!0,className:"modal",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{style:{fontSize:"1.3rem"},children:message})});try{FatalErrorStateModal.displayName="FatalErrorStateModal",FatalErrorStateModal.__docgenInfo={description:"",displayName:"FatalErrorStateModal",props:{title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},message:{defaultValue:null,description:"",name:"message",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["components/modals/FatalErrorStateModal/FatalErrorStateModal.tsx#FatalErrorStateModal"]={docgenInfo:FatalErrorStateModal.__docgenInfo,name:"FatalErrorStateModal",path:"components/modals/FatalErrorStateModal/FatalErrorStateModal.tsx#FatalErrorStateModal"})}catch(__react_docgen_typescript_loader_error){}},"./utils/apis.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{D0:()=>FEDERATION_MESSAGE_SEND,DW:()=>getUnauthedData,Fd:()=>fetchData,Fq:()=>SERVER_CONFIG,XQ:()=>STATUS,e0:()=>upgradeVersionAvailable,nn:()=>SERVER_CONFIG_UPDATE_URL,r1:()=>FETCH_INTERVAL});var process=__webpack_require__("./node_modules/process/browser.js"),console=__webpack_require__("./node_modules/console-browserify/index.js");const ADMIN_USERNAME=process.env.NEXT_PUBLIC_ADMIN_USERNAME,ADMIN_STREAMKEY=process.env.NEXT_PUBLIC_ADMIN_STREAMKEY,API_LOCATION="/api/admin/",FETCH_INTERVAL=15e3,STATUS=`${API_LOCATION}status`,SERVER_CONFIG=`${API_LOCATION}serverconfig`,SERVER_CONFIG_UPDATE_URL=`${API_LOCATION}config`,FEDERATION_MESSAGE_SEND=`${API_LOCATION}federation/send`,GITHUB_RELEASE_URL="https://api.github.com/repos/owncast/owncast/releases/latest";async function fetchData(url,options){const{data,method="GET",auth=!0}=options||{},requestOptions={method};if(data&&(requestOptions.body=JSON.stringify(data)),auth&&ADMIN_USERNAME&&ADMIN_STREAMKEY){const encoded=btoa(`${ADMIN_USERNAME}:${ADMIN_STREAMKEY}`);requestOptions.headers={Authorization:`Basic ${encoded}`},requestOptions.mode="cors",requestOptions.credentials="include"}const response=await fetch(url,requestOptions),json=await response.json();if(!response.ok){const message=json.message||`An error has occurred: ${response.status}`;throw new Error(message)}return json}async function getUnauthedData(url,options){return fetchData(url,{method:"GET",auth:!1,...options})}async function getGithubRelease(){return async function fetchExternalData(url){try{const response=await fetch(url,{referrerPolicy:"no-referrer",referrer:""});if(!response.ok){const message=`An error has occured: ${response.status}`;throw new Error(message)}return await response.json()}catch(error){console.log(error)}return{}}(GITHUB_RELEASE_URL)}const VPAT=/^\d+(\.\d+){0,2}$/;async function upgradeVersionAvailable(currentVersion){let recentReleaseVersion=(await getGithubRelease()).tag_name;return"v"===recentReleaseVersion.substr(0,1)&&(recentReleaseVersion=recentReleaseVersion.substr(1)),function upToDate(local,remote){if(!local||!remote||0===local.length||0===remote.length)return!1;if(local===remote)return!0;if(VPAT.test(local)&&VPAT.test(remote)){const lparts=local.split(".");for(;lparts.length<3;)lparts.push("0");const rparts=remote.split(".");for(;rparts.length<3;)rparts.push("0");for(let i=0;i<3;i++){const l=parseInt(lparts[i],10),r=parseInt(rparts[i],10);if(l!==r)return l>r}return!0}return local>=remote}(currentVersion,recentReleaseVersion)?null:recentReleaseVersion}},"./utils/format.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ld:()=>formatUAstring,RW:()=>parseSecondsToDurationString});var ua_parser_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/ua-parser-js/src/ua-parser.js"),ua_parser_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(ua_parser_js__WEBPACK_IMPORTED_MODULE_0__);function padLeft(text,pad,size){return String(pad.repeat(size)+text).slice(-size)}function parseSecondsToDurationString(seconds=0){const finiteSeconds=Number.isFinite(+seconds)?Math.abs(seconds):0,days=Math.floor(finiteSeconds/86400),daysString=days>0?`${days} day${days>1?"s":""} `:"",hours=Math.floor(finiteSeconds/3600%24);return daysString+(hours||days?padLeft(`${hours}:`,"0",3):"")+padLeft(`${Math.floor(finiteSeconds/60%60)}:`,"0",3)+padLeft(`${Math.floor(finiteSeconds%60)}`,"0",2)}function formatUAstring(uaString){const parser=ua_parser_js__WEBPACK_IMPORTED_MODULE_0___default()(uaString),{device,os,browser}=parser,{major:browserVersion,name}=browser,{version:osVersion,name:osName}=os,{model,type}=device;if("libmpv"===uaString)return"mpv media player";if(!name||!browserVersion||!osName)return uaString;return`${name} ${browserVersion} on ${osName} ${osVersion}\n  ${model||type?` (${model||type})`:""}`}},"./utils/validators.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{AY:()=>isValidUrl,JP:()=>isValidFediverseAccount,vI:()=>DEFAULT_TEXTFIELD_URL_PATTERN});const DEFAULT_TEXTFIELD_URL_PATTERN="https?://.*";function isValidUrl(url,validProtocols=["http:","https:"]){try{const validationObject=new URL(url);if(""===validationObject.protocol||""===validationObject.hostname||!validProtocols.includes(validationObject.protocol))return!1}catch(e){return!1}return!0}function isValidFediverseAccount(account){const sanitized=account.replace(/^@+/,"");return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(sanitized).toLowerCase())}}}]);